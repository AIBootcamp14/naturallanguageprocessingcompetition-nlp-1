# ë°ì´í„° ì¦ê°• ì‹œìŠ¤í…œ ìƒì„¸ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [DataAugmenter](#dataaugmenter)
3. [ì¦ê°• ë°©ë²•](#ì¦ê°•-ë°©ë²•)
4. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
5. [ì‹¤í–‰ ëª…ë ¹ì–´](#ì‹¤í–‰-ëª…ë ¹ì–´)

---

## ğŸ“ ê°œìš”

### ëª©ì 
- í•™ìŠµ ë°ì´í„° ì¦ê°•ìœ¼ë¡œ ëª¨ë¸ ì¼ë°˜í™” ì„±ëŠ¥ í–¥ìƒ
- 5ê°€ì§€ ì¦ê°• ë°©ë²• ì§€ì›
- ìœ ì—°í•œ ì¡°í•© ê°€ëŠ¥

### í•µì‹¬ ê¸°ëŠ¥
- âœ… Back-translation (í•œâ†’ì˜â†’í•œ)
- âœ… Paraphrase ìƒì„±
- âœ… ëŒ€í™” í„´ ì„ê¸°
- âœ… ë™ì˜ì–´ ì¹˜í™˜
- âœ… ëŒ€í™” ìƒ˜í”Œë§

---

## ğŸ—ï¸ DataAugmenter

### íŒŒì¼ ìœ„ì¹˜
```
src/data/augmentation.py
```

### í´ë˜ìŠ¤ êµ¬ì¡°

```python
class DataAugmenter:
    def __init__(logger=None)
    def augment(dialogues, summaries, methods, samples_per_method)
    def back_translate(text)
    def paraphrase(text)
    def shuffle_turns(dialogue, preserve_ratio)
    def synonym_replacement(text, n)
    def sample_dialogue(dialogue, ratio)
```

---

## ğŸ”„ ì¦ê°• ë°©ë²•

### 1. Back-translation (ì—­ë²ˆì—­)

**ì›ë¦¬:**
- í•œêµ­ì–´ â†’ ì˜ì–´ â†’ í•œêµ­ì–´ ë²ˆì—­
- Helsinki-NLP MarianMT ëª¨ë¸ ì‚¬ìš©

**ì½”ë“œ:**
```python
from src.data.augmentation import BackTranslationAugmenter

augmenter = BackTranslationAugmenter()
aug_dialogue, aug_summary = augmenter.augment(dialogue, summary)
```

**ì˜ˆì‹œ:**
```
ì›ë³¸: "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì •ë§ ì¢‹ë„¤ìš”"
ì¦ê°•: "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ë§¤ìš° ì¢‹ìŠµë‹ˆë‹¤"
```

**íŠ¹ì§•:**
- ì˜ë¯¸ëŠ” ìœ ì§€í•˜ë©´ì„œ í‘œí˜„ ë³€ê²½
- GPU ì‚¬ìš© ê¶Œì¥ (ëª¨ë¸ ë¡œë”© í•„ìš”)
- ì„ íƒì  ì‚¬ìš© (SentencePiece ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”)

---

### 2. Paraphrase (ì˜ì—­)

**ì›ë¦¬:**
- ê·œì¹™ ê¸°ë°˜ ë™ì˜ì–´ ì¹˜í™˜
- ì£¼ìš” í‘œí˜„ ë³€í˜•

**ì½”ë“œ:**
```python
from src.data.augmentation import ParaphraseAugmenter

augmenter = ParaphraseAugmenter()
aug_dialogue, aug_summary = augmenter.augment(dialogue, summary)
```

**ì¹˜í™˜ ê·œì¹™:**
```python
{
    "ì•ˆë…•í•˜ì„¸ìš”": ["ì•ˆë…•", "ë°˜ê°‘ìŠµë‹ˆë‹¤", "í™˜ì˜í•©ë‹ˆë‹¤"],
    "ê°ì‚¬í•©ë‹ˆë‹¤": ["ê³ ë§™ìŠµë‹ˆë‹¤", "ê°ì‚¬í•´ìš”", "ê³ ë§ˆì›Œìš”"],
    "ì£„ì†¡í•©ë‹ˆë‹¤": ["ë¯¸ì•ˆí•©ë‹ˆë‹¤", "ì£„ì†¡í•´ìš”", "ë¯¸ì•ˆí•´ìš”"],
    "ë„¤": ["ì˜ˆ", "ì•Œê² ìŠµë‹ˆë‹¤", "ê·¸ë ‡ìŠµë‹ˆë‹¤"],
    "ì•„ë‹ˆìš”": ["ì•„ë‹™ë‹ˆë‹¤", "ì•„ë‹ˆì—ìš”", "ê·¸ë ‡ì§€ ì•ŠìŠµë‹ˆë‹¤"]
}
```

**ì˜ˆì‹œ:**
```
ì›ë³¸: "ì•ˆë…•í•˜ì„¸ìš”. ê°ì‚¬í•©ë‹ˆë‹¤."
ì¦ê°•: "ë°˜ê°‘ìŠµë‹ˆë‹¤. ê³ ë§™ìŠµë‹ˆë‹¤."
```

---

### 3. Turn Shuffling (í„´ ì„ê¸°)

**ì›ë¦¬:**
- ëŒ€í™” í„´ ìˆœì„œ ë¬´ì‘ìœ„ ì„ê¸°
- ì²˜ìŒ/ë ì¼ë¶€ ë³´ì¡´ (ë§¥ë½ ìœ ì§€)

**ì½”ë“œ:**
```python
from src.data.augmentation import ShuffleAugmenter

augmenter = ShuffleAugmenter(preserve_ratio=0.3)
aug_dialogue, aug_summary = augmenter.augment(dialogue, summary)
```

**íŒŒë¼ë¯¸í„°:**
- `preserve_ratio`: ë³´ì¡´í•  í„´ ë¹„ìœ¨ (ê¸°ë³¸ê°’: 0.3)

**ì˜ˆì‹œ:**
```
ì›ë³¸:
A: ì•ˆë…•í•˜ì„¸ìš”
B: ì•ˆë…•í•˜ì„¸ìš”
A: ì˜¤ëŠ˜ ë‚ ì”¨ ì¢‹ë„¤ìš”
B: ë„¤, ì •ë§ ì¢‹ì•„ìš”
A: ì ì‹¬ ë­ ë¨¹ì„ê¹Œìš”?
B: ê¹€ì¹˜ì°Œê°œ ì–´ë•Œìš”?

ì¦ê°•:
A: ì•ˆë…•í•˜ì„¸ìš”        # ì²˜ìŒ ë³´ì¡´
B: ì•ˆë…•í•˜ì„¸ìš”        # ì²˜ìŒ ë³´ì¡´
A: ì ì‹¬ ë­ ë¨¹ì„ê¹Œìš”? # ì¤‘ê°„ ì„ì„
B: ê¹€ì¹˜ì°Œê°œ ì–´ë•Œìš”?  # ì¤‘ê°„ ì„ì„
A: ì˜¤ëŠ˜ ë‚ ì”¨ ì¢‹ë„¤ìš”  # ì¤‘ê°„ ì„ì„
B: ë„¤, ì •ë§ ì¢‹ì•„ìš”   # ë ë³´ì¡´
```

**íŠ¹ì§•:**
- ìš”ì•½ì€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
- ëŒ€í™” ìˆœì„œì— ë¯¼ê°í•˜ì§€ ì•Šì€ ê²½ìš° ìœ ìš©

---

### 4. Synonym Replacement (ë™ì˜ì–´ ì¹˜í™˜)

**ì›ë¦¬:**
- íŠ¹ì • ë‹¨ì–´ë¥¼ ë™ì˜ì–´ë¡œ ì¹˜í™˜
- í•œêµ­ì–´ ë™ì˜ì–´ ì‚¬ì „ ê¸°ë°˜

**ì½”ë“œ:**
```python
from src.data.augmentation import SynonymReplacementAugmenter

augmenter = SynonymReplacementAugmenter(replace_ratio=0.3)
aug_dialogue, aug_summary = augmenter.augment(dialogue, summary)
```

**ë™ì˜ì–´ ì‚¬ì „:**
```python
{
    "ì¢‹ë‹¤": ["í›Œë¥­í•˜ë‹¤", "ë©‹ì§€ë‹¤", "ê´œì°®ë‹¤"],
    "ë‚˜ì˜ë‹¤": ["ì•ˆì¢‹ë‹¤", "ë³„ë¡œë‹¤", "í˜•í¸ì—†ë‹¤"],
    "í¬ë‹¤": ["ê±°ëŒ€í•˜ë‹¤", "ë„“ë‹¤", "ê´‘ëŒ€í•˜ë‹¤"],
    "ì‘ë‹¤": ["ì ë‹¤", "ë¯¸ë¯¸í•˜ë‹¤", "ì†Œì†Œí•˜ë‹¤"],
    "ë¹ ë¥´ë‹¤": ["ì‹ ì†í•˜ë‹¤", "ì¬ë¹ ë¥´ë‹¤", "ë‚ ìŒ”ë‹¤"],
    "ëŠë¦¬ë‹¤": ["ë”ë””ë‹¤", "êµ¼ëœ¨ë‹¤", "ëŠ¦ë‹¤"],
    "ë°¥": ["ì‹ì‚¬", "ìŒì‹", "ë¼ë‹ˆ"],
    "ë¨¹ë‹¤": ["ì„­ì·¨í•˜ë‹¤", "ë“œì‹œë‹¤", "ì‹ì‚¬í•˜ë‹¤"]
}
```

**ì˜ˆì‹œ:**
```
ì›ë³¸: "ì˜¤ëŠ˜ ì ì‹¬ì— ë°¥ì„ ë¨¹ì—ˆë‹¤"
ì¦ê°•: "ì˜¤ëŠ˜ ì ì‹¬ì— ì‹ì‚¬ë¥¼ ë¨¹ì—ˆë‹¤"
```

---

### 5. Dialogue Sampling (ëŒ€í™” ìƒ˜í”Œë§)

**ì›ë¦¬:**
- ê¸´ ëŒ€í™”ì—ì„œ ì¼ë¶€ í„´ë§Œ ì„ íƒ
- ì²˜ìŒê³¼ ë í„´ í•­ìƒ ìœ ì§€

**ì½”ë“œ:**
```python
from src.data.augmentation import DialogueSamplingAugmenter

augmenter = DialogueSamplingAugmenter(sample_ratio=0.7)
aug_dialogue, aug_summary = augmenter.augment(dialogue, summary)
```

**íŒŒë¼ë¯¸í„°:**
- `sample_ratio`: ìœ ì§€í•  í„´ ë¹„ìœ¨ (ê¸°ë³¸ê°’: 0.7)

**ì˜ˆì‹œ:**
```
ì›ë³¸ (8í„´):
A: 1
B: 2
A: 3
B: 4
A: 5
B: 6
A: 7
B: 8

ì¦ê°• (5í„´, 70%):
A: 1       # ì²˜ìŒ ìœ ì§€
B: 2       # ëœë¤ ì„ íƒ
A: 5       # ëœë¤ ì„ íƒ
A: 7       # ëœë¤ ì„ íƒ
B: 8       # ë ìœ ì§€
```

**íŠ¹ì§•:**
- ìš”ì•½ì€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
- ê¸´ ëŒ€í™” ìš”ì•½ í•™ìŠµì— ìœ ìš©

---

## ğŸ’» ì‚¬ìš© ë°©ë²•

### 1. ë‹¨ì¼ ë°©ë²• ì‚¬ìš©

```python
from src.data.augmentation import ShuffleAugmenter

augmenter = ShuffleAugmenter(preserve_ratio=0.3)

dialogue = "A: ì•ˆë…•\nB: ì•ˆë…•\nA: ë‚ ì”¨ ì¢‹ë„¤\nB: ë„¤"
summary = "ì¸ì‚¬ ë° ë‚ ì”¨"

aug_dialogue, aug_summary = augmenter.augment(dialogue, summary)
```

---

### 2. DataAugmenterë¡œ ì—¬ëŸ¬ ë°©ë²• ì‚¬ìš©

```python
from src.data.augmentation import DataAugmenter

augmenter = DataAugmenter()

dialogues = ["ëŒ€í™”1", "ëŒ€í™”2", "ëŒ€í™”3"]
summaries = ["ìš”ì•½1", "ìš”ì•½2", "ìš”ì•½3"]

# 3ê°€ì§€ ë°©ë²• ì ìš©, ê° ë°©ë²•ë‹¹ 2ê°œì”© ìƒì„±
aug_dialogues, aug_summaries = augmenter.augment(
    dialogues,
    summaries,
    methods=['shuffle', 'synonym', 'sample'],
    samples_per_method=2
)

print(f"ì›ë³¸: {len(dialogues)}ê°œ")
print(f"ì¦ê°• í›„: {len(aug_dialogues)}ê°œ")  # 3 + (3 Ã— 3 Ã— 2) = 21ê°œ
```

---

### 3. í¸ì˜ í•¨ìˆ˜ ì‚¬ìš© (augment_dataset)

```python
from src.data.augmentation import augment_dataset
import pandas as pd

# ë°ì´í„° ë¡œë“œ
train_df = pd.read_csv("data/raw/train.csv")

# ì¦ê°• ì‹¤í–‰
aug_dialogues, aug_summaries = augment_dataset(
    dialogues=train_df['dialogue'].tolist(),
    summaries=train_df['summary'].tolist(),
    methods=['shuffle', 'sample'],
    n_aug=2  # ê° ë°©ë²•ë‹¹ 2ê°œì”©
)

print(f"ì›ë³¸: {len(train_df)}ê°œ")
print(f"ì¦ê°• í›„: {len(aug_dialogues)}ê°œ")
# 12,457ê°œ â†’ 12,457 Ã— 2 Ã— 2 = 49,828ê°œ
```

---

### 4. í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ì— í†µí•©

```python
from src.config import load_config
from src.data.augmentation import augment_dataset
from src.data.preprocessor import create_dataset
import pandas as pd

# 1. Config ë¡œë“œ
config = load_config("baseline_kobart")

# 2. ë°ì´í„° ë¡œë“œ
train_df = pd.read_csv("data/raw/train.csv")

# 3. ë°ì´í„° ì¦ê°•
if config.data.augmentation.enabled:
    aug_dialogues, aug_summaries = augment_dataset(
        dialogues=train_df['dialogue'].tolist(),
        summaries=train_df['summary'].tolist(),
        methods=config.data.augmentation.methods,
        n_aug=config.data.augmentation.n_aug
    )

    # ì¦ê°• ë°ì´í„°ë¥¼ DataFrameì— ì¶”ê°€
    aug_df = pd.DataFrame({
        'dialogue': aug_dialogues,
        'summary': aug_summaries
    })
    train_df = pd.concat([train_df, aug_df], ignore_index=True)

# 4. Dataset ìƒì„±
train_dataset = create_dataset(
    dialogues=train_df['dialogue'].tolist(),
    summaries=train_df['summary'].tolist(),
    tokenizer=tokenizer,
    config=config
)
```

---

## ğŸ”§ ì‹¤í–‰ ëª…ë ¹ì–´

### Config ì„¤ì •

**íŒŒì¼:** `configs/experiments/baseline_kobart.yaml`

```yaml
data:
  augmentation:
    enabled: true
    methods:
      - shuffle
      - sample
    n_aug: 2  # ê° ë°©ë²•ë‹¹ 2ê°œì”© ìƒì„±
```

---

### í•™ìŠµ ì‹œ ìë™ ì¦ê°•

í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ Config ê¸°ë°˜ìœ¼ë¡œ ìë™ ì¦ê°•:

```bash
# Configì— augmentation ì„¤ì •ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ì¦ê°•ë¨
python scripts/train.py --experiment baseline_kobart
```

---

## ğŸ“‚ Config íŒŒì¼

### ì¦ê°• ì„¤ì • ì˜ˆì‹œ

```yaml
data:
  train_path: "data/raw/train.csv"
  dev_path: "data/raw/dev.csv"

  augmentation:
    enabled: true
    methods:
      - shuffle        # í„´ ì„ê¸°
      - sample         # ëŒ€í™” ìƒ˜í”Œë§
      - synonym        # ë™ì˜ì–´ ì¹˜í™˜
    n_aug: 2           # ê° ë°©ë²•ë‹¹ 2ê°œì”©
```

**ê²°ê³¼:**
- ì›ë³¸: 12,457ê°œ
- ì¦ê°• í›„: 12,457 + (12,457 Ã— 3 Ã— 2) = **87,399ê°œ**

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ íŒŒì¼ ìœ„ì¹˜
```
src/tests/test_augmentation.py
```

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
python src/tests/test_augmentation.py
```

### í…ŒìŠ¤íŠ¸ í•­ëª© (ì´ 7ê°œ)

1. âœ… DataAugmenter ì´ˆê¸°í™”
2. âœ… ì—­ë²ˆì—­ ì¦ê°• (ì„ íƒì )
3. âœ… ì˜ì—­ ì¦ê°•
4. âœ… í„´ ì„ê¸° ì¦ê°•
5. âœ… ë™ì˜ì–´ ì¹˜í™˜ ì¦ê°•
6. âœ… ëŒ€í™” ìƒ˜í”Œë§ ì¦ê°•
7. âœ… augment_dataset í•¨ìˆ˜

**ê²°ê³¼:** 7/7 í…ŒìŠ¤íŠ¸ í†µê³¼ (100%)

---

## ğŸ“Š ì¦ê°• íš¨ê³¼

### ë°ì´í„° ì¦ê°€ëŸ‰

| ë°©ë²• ìˆ˜ | n_aug | ì›ë³¸ | ì¦ê°• í›„ | ì¦ê°€ìœ¨ |
|---------|-------|------|---------|--------|
| 1ê°œ | 1 | 12,457 | 24,914 | 2ë°° |
| 2ê°œ | 1 | 12,457 | 37,371 | 3ë°° |
| 3ê°œ | 1 | 12,457 | 49,828 | 4ë°° |
| 2ê°œ | 2 | 12,457 | 62,285 | 5ë°° |
| 3ê°œ | 2 | 12,457 | 87,399 | 7ë°° |

---

### ê¶Œì¥ ì¡°í•©

#### 1. ê°€ë²¼ìš´ ì¦ê°• (2ë°°)
```yaml
methods: [shuffle]
n_aug: 1
```
- ë¹ ë¥¸ í•™ìŠµ
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì 

#### 2. ì¤‘ê°„ ì¦ê°• (4ë°°)
```yaml
methods: [shuffle, sample]
n_aug: 2
```
- ê· í˜•ìˆëŠ” ì„±ëŠ¥ í–¥ìƒ
- í•™ìŠµ ì‹œê°„ ì ì ˆ

#### 3. ê°•ë ¥í•œ ì¦ê°• (7ë°°)
```yaml
methods: [shuffle, sample, synonym]
n_aug: 2
```
- ìµœëŒ€ ì„±ëŠ¥ í–¥ìƒ
- ê¸´ í•™ìŠµ ì‹œê°„ í•„ìš”

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. Back-translation
- Helsinki-NLP ëª¨ë¸ ë‹¤ìš´ë¡œë“œ í•„ìš” (ì•½ 300MB Ã— 2)
- SentencePiece ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”
- GPU ê¶Œì¥ (ëŠë¦° ì†ë„)

### 2. ë©”ëª¨ë¦¬
- ì¦ê°• ë°ì´í„°ëŠ” ë©”ëª¨ë¦¬ì— ë¡œë“œë¨
- 7ë°° ì¦ê°• ì‹œ: 12,457ê°œ â†’ 87,399ê°œ
- ë°°ì¹˜ í¬ê¸° ì¡°ì • í•„ìš”í•  ìˆ˜ ìˆìŒ

### 3. í•™ìŠµ ì‹œê°„
- ë°ì´í„°ê°€ ë§ì•„ì§€ë©´ í•™ìŠµ ì‹œê°„ ì¦ê°€
- ì—í¬í¬ ìˆ˜ ì¡°ì • ê³ ë ¤

---

## ğŸ¯ ì„±ëŠ¥ ëª©í‘œ

### ì¦ê°• ì „í›„ ë¹„êµ

| ëª¨ë¸ | ì¦ê°• ì „ | ì¦ê°• í›„ (4ë°°) | ê°œì„  |
|------|---------|---------------|------|
| KoBART | ROUGE 88-90 | **ROUGE 92-95** | +4-5 |

---

## ğŸ”— ê´€ë ¨ íŒŒì¼

**ì†ŒìŠ¤ ì½”ë“œ:**
- `src/data/augmentation.py` - ì¦ê°• ì‹œìŠ¤í…œ

**í…ŒìŠ¤íŠ¸:**
- `src/tests/test_augmentation.py` - ì¦ê°• í…ŒìŠ¤íŠ¸

**ë¬¸ì„œ:**
- `docs/ëª¨ë“ˆí™”/00_ì „ì²´_ì‹œìŠ¤í…œ_ê°œìš”.md` - ì‹œìŠ¤í…œ ê°œìš”
- `docs/ëª¨ë“ˆí™”/ì‹¤í–‰_ëª…ë ¹ì–´_ì´ì •ë¦¬.md` - ì‹¤í–‰ ëª…ë ¹ì–´
