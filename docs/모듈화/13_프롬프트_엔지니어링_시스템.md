# í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ì‹œìŠ¤í…œ ìƒì„¸ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [PromptTemplate í´ë˜ìŠ¤](#prompttemplate-í´ë˜ìŠ¤)
3. [PromptLibrary í´ë˜ìŠ¤](#promptlibrary-í´ë˜ìŠ¤)
4. [PromptSelector í´ë˜ìŠ¤](#promptselector-í´ë˜ìŠ¤)
5. [í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì¢…ë¥˜](#í”„ë¡¬í”„íŠ¸-í…œí”Œë¦¿-ì¢…ë¥˜)
6. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
7. [ì‹¤í–‰ ëª…ë ¹ì–´](#ì‹¤í–‰-ëª…ë ¹ì–´)

---

## ğŸ“ ê°œìš”

### ëª©ì 
- Solar API ë° LLMì˜ ì„±ëŠ¥ ê·¹ëŒ€í™”
- ëŒ€í™” íŠ¹ì„±ë³„ ìµœì  í”„ë¡¬í”„íŠ¸ ìë™ ì„ íƒ
- í† í° ì‚¬ìš©ëŸ‰ ìµœì†Œí™”í•˜ë©´ì„œ í’ˆì§ˆ ìœ ì§€
- ì¼ê´€ëœ ì¶œë ¥ í˜•ì‹ ë³´ì¥

### í•µì‹¬ ê¸°ëŠ¥
- âœ… 16ê°œ ì‚¬ì „ ì •ì˜ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
- âœ… ëŒ€í™” ê¸¸ì´/ì°¸ì—¬ì ìˆ˜/í† í° ì˜ˆì‚° ê¸°ë°˜ ë™ì  ì„ íƒ
- âœ… Zero-shot, Few-shot, Chain-of-Thought ì§€ì›
- âœ… í† í° ì¶”ì • ë° ì••ì¶• í…œí”Œë¦¿
- âœ… ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ì¶”ê°€ ì§€ì›

---

## ğŸ¯ PromptTemplate í´ë˜ìŠ¤

### íŒŒì¼ ìœ„ì¹˜
```
src/prompts/template.py
```

### í´ë˜ìŠ¤ êµ¬ì¡°

```python
@dataclass
class PromptTemplate:
    name: str              # í…œí”Œë¦¿ ì´ë¦„
    template: str          # í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´
    description: str       # ì„¤ëª…
    category: str          # ì¹´í…Œê³ ë¦¬
    variables: List[str]   # í•„ìˆ˜ ë³€ìˆ˜ ëª©ë¡

    def format(**kwargs) -> str  # í…œí”Œë¦¿ í¬ë§·íŒ…
```

### ì‚¬ìš© ì˜ˆì‹œ

```python
from src.prompts import PromptTemplate

# í…œí”Œë¦¿ ìƒì„±
template = PromptTemplate(
    name="custom_summary",
    template="""ë‹¤ìŒ ëŒ€í™”ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”:

{dialogue}

ìš”ì•½ ({style} ìŠ¤íƒ€ì¼):""",
    description="ìŠ¤íƒ€ì¼ ì§€ì • ê°€ëŠ¥í•œ í…œí”Œë¦¿",
    category="custom",
    variables=["dialogue", "style"]
)

# í…œí”Œë¦¿ í¬ë§·íŒ…
prompt = template.format(
    dialogue="A: ì•ˆë…• B: ì•ˆë…•",
    style="ê°„ê²°í•œ"
)

print(prompt)
# ì¶œë ¥:
# ë‹¤ìŒ ëŒ€í™”ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”:
#
# A: ì•ˆë…• B: ì•ˆë…•
#
# ìš”ì•½ (ê°„ê²°í•œ ìŠ¤íƒ€ì¼):
```

---

## ğŸ“š PromptLibrary í´ë˜ìŠ¤

### ê¸°ëŠ¥

- 16ê°œ ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ê´€ë¦¬
- í…œí”Œë¦¿ ì¡°íšŒ, ì¶”ê°€, ë¶„ë¥˜
- í† í° ìˆ˜ ì¶”ì •

### ì£¼ìš” ë©”ì„œë“œ

```python
class PromptLibrary:
    def get_template(name: str) -> PromptTemplate
    def add_template(template: PromptTemplate)
    def list_templates(category: Optional[str]) -> List[str]
    def get_templates_by_category(category: str) -> List[PromptTemplate]
    def estimate_tokens(template_name: str, **kwargs) -> int
```

### ì‚¬ìš© ì˜ˆì‹œ

```python
from src.prompts import PromptLibrary

# ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„±
library = PromptLibrary()

# í…œí”Œë¦¿ ì¡°íšŒ
template = library.get_template('zero_shot_basic')

# ì¹´í…Œê³ ë¦¬ë³„ ëª©ë¡
zero_shot_templates = library.list_templates(category='zero_shot')
print(zero_shot_templates)
# ['zero_shot_basic', 'zero_shot_detailed', 'zero_shot_structured']

# í…œí”Œë¦¿ í¬ë§·íŒ…
dialogue = "A: ì•ˆë…•í•˜ì„¸ìš” B: ì•ˆë…•í•˜ì„¸ìš”"
prompt = template.format(dialogue=dialogue)

# í† í° ì¶”ì •
tokens = library.estimate_tokens('zero_shot_basic', dialogue=dialogue)
print(f"ì˜ˆìƒ í† í°: {tokens}")
# ì˜ˆìƒ í† í°: 14

# ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ì¶”ê°€
from src.prompts import PromptTemplate

custom = PromptTemplate(
    name="my_template",
    template="ìš”ì•½: {text}",
    description="ë‚˜ë§Œì˜ í…œí”Œë¦¿",
    category="custom",
    variables=["text"]
)

library.add_template(custom)
```

---

## ğŸ” PromptSelector í´ë˜ìŠ¤

### ê¸°ëŠ¥

ëŒ€í™” íŠ¹ì„±ì„ ë¶„ì„í•˜ì—¬ ìµœì  í”„ë¡¬í”„íŠ¸ë¥¼ ìë™ ì„ íƒ

### ì„ íƒ ì „ëµ

1. **ê¸¸ì´ ê¸°ë°˜ ì„ íƒ** - ë‹¨ì–´ ìˆ˜ì— ë”°ë¼
2. **ì°¸ì—¬ì ìˆ˜ ê¸°ë°˜ ì„ íƒ** - 2ì¸/ì†Œê·¸ë£¹/ëŒ€ê·œëª¨
3. **í† í° ì˜ˆì‚° ê¸°ë°˜ ì„ íƒ** - ì••ì¶• í•„ìš” ì—¬ë¶€
4. **ì¹´í…Œê³ ë¦¬ ê¸°ë°˜ ì„ íƒ** - Zero-shot/Few-shot/CoT
5. **ì ì‘í˜• ì„ íƒ** - ì¢…í•©ì  ë¶„ì„

### ì£¼ìš” ë©”ì„œë“œ

```python
class PromptSelector:
    def select_by_length(dialogue: str) -> PromptTemplate
    def select_by_speakers(dialogue: str) -> PromptTemplate
    def select_by_token_budget(dialogue: str, token_budget: int) -> PromptTemplate
    def select_by_category(category: str, dialogue: str, **kwargs) -> PromptTemplate
    def select_adaptive(dialogue: str, token_budget: int, prefer_category: str) -> PromptTemplate
    def get_selection_info(dialogue: str) -> Dict[str, Any]
```

### ì‚¬ìš© ì˜ˆì‹œ

```python
from src.prompts import PromptSelector

selector = PromptSelector()

dialogue = "#Person1#: ì•ˆë…•í•˜ì„¸ìš” #Person2#: ì•ˆë…•í•˜ì„¸ìš”"

# 1. ê¸¸ì´ ê¸°ë°˜ ì„ íƒ
template = selector.select_by_length(dialogue)
print(f"ê¸¸ì´ ê¸°ë°˜: {template.name}")
# ê¸¸ì´ ê¸°ë°˜: short_dialogue

# 2. ì°¸ì—¬ì ìˆ˜ ê¸°ë°˜ ì„ íƒ
template = selector.select_by_speakers(dialogue)
print(f"ì°¸ì—¬ì ìˆ˜ ê¸°ë°˜: {template.name}")
# ì°¸ì—¬ì ìˆ˜ ê¸°ë°˜: two_speakers

# 3. í† í° ì˜ˆì‚° ê¸°ë°˜ ì„ íƒ
template = selector.select_by_token_budget(dialogue, token_budget=100)
print(f"í† í° ì˜ˆì‚° ê¸°ë°˜: {template.name}")
# í† í° ì˜ˆì‚° ê¸°ë°˜: zero_shot_detailed

# 4. ì ì‘í˜• ì„ íƒ (ìë™ ìµœì í™”)
template = selector.select_adaptive(
    dialogue=dialogue,
    token_budget=512,
    prefer_category="zero_shot"
)
print(f"ì ì‘í˜•: {template.name}")
# ì ì‘í˜•: zero_shot_basic

# 5. ëŒ€í™” ë¶„ì„ ì •ë³´
info = selector.get_selection_info(dialogue)
print(f"ë‹¨ì–´ ìˆ˜: {info['word_count']}")
print(f"ì°¸ì—¬ì ìˆ˜: {info['num_speakers']}")
print(f"ì¶”ì • í† í°: {info['estimated_tokens']}")
print(f"ì¶”ì²œ:")
for criterion, template_name in info['recommendations'].items():
    print(f"  {criterion}: {template_name}")
```

---

## ğŸ“ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì¢…ë¥˜

### 1. Zero-shot í…œí”Œë¦¿ (3ê°œ)

ì˜ˆì‹œ ì—†ì´ ì§ì ‘ ìš”ì•½í•˜ëŠ” í…œí”Œë¦¿

| í…œí”Œë¦¿ ì´ë¦„ | ì„¤ëª… | ì‚¬ìš© ì‹œê¸° |
|-----------|------|---------|
| zero_shot_basic | ê¸°ë³¸ í…œí”Œë¦¿ | ì§§ì€ ëŒ€í™”, ë¹ ë¥¸ ì²˜ë¦¬ |
| zero_shot_detailed | ìƒì„¸ í…œí”Œë¦¿ | ê¸´ ëŒ€í™”, í’ˆì§ˆ ì¤‘ì‹œ |
| zero_shot_structured | êµ¬ì¡°í™” í…œí”Œë¦¿ | ì¼ê´€ëœ í˜•ì‹ í•„ìš” |

**ì˜ˆì‹œ: zero_shot_basic**
```
ë‹¤ìŒ ëŒ€í™”ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”:

{dialogue}

ìš”ì•½:
```

---

### 2. Few-shot í…œí”Œë¦¿ (3ê°œ)

ì˜ˆì‹œë¥¼ ì œê³µí•˜ì—¬ í•™ìŠµì‹œí‚¤ëŠ” í…œí”Œë¦¿

| í…œí”Œë¦¿ ì´ë¦„ | ì˜ˆì‹œ ê°œìˆ˜ | ì‚¬ìš© ì‹œê¸° |
|-----------|---------|---------|
| few_shot_1shot | 1ê°œ | ë‹¨ìˆœ íŒ¨í„´ |
| few_shot_2shot | 2ê°œ | ì¼ë°˜ì  ìƒí™© |
| few_shot_3shot | 3ê°œ | ë³µì¡í•œ íŒ¨í„´ |

**ì˜ˆì‹œ: few_shot_2shot**
```
ëŒ€í™” ìš”ì•½ ì˜ˆì‹œë¥¼ ì°¸ê³ í•˜ì—¬ ë§ˆì§€ë§‰ ëŒ€í™”ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”.

ì˜ˆì‹œ 1:
ëŒ€í™”: {example1_dialogue}
ìš”ì•½: {example1_summary}

ì˜ˆì‹œ 2:
ëŒ€í™”: {example2_dialogue}
ìš”ì•½: {example2_summary}

ì´ì œ ë‹¤ìŒ ëŒ€í™”ë¥¼ ìš”ì•½í•´ì£¼ì„¸ìš”:
ëŒ€í™”: {dialogue}
ìš”ì•½:
```

---

### 3. Chain-of-Thought (CoT) í…œí”Œë¦¿ (2ê°œ)

ë‹¨ê³„ë³„ ì‚¬ê³  ê³¼ì •ì„ ìœ ë„í•˜ëŠ” í…œí”Œë¦¿

| í…œí”Œë¦¿ ì´ë¦„ | ì„¤ëª… | ì‚¬ìš© ì‹œê¸° |
|-----------|------|---------|
| cot_step_by_step | ë‹¨ê³„ë³„ í…œí”Œë¦¿ | ë³µì¡í•œ ëŒ€í™” |
| cot_analytical | ë¶„ì„ì  í…œí”Œë¦¿ | ê¸´ ëŒ€í™” (300+ ë‹¨ì–´) |

**ì˜ˆì‹œ: cot_step_by_step**
```
ë‹¤ìŒ ëŒ€í™”ë¥¼ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•˜ì—¬ ìš”ì•½í•´ì£¼ì„¸ìš”.

ë‹¨ê³„ 1: ëŒ€í™”ì˜ ì£¼ìš” ì£¼ì œ íŒŒì•…
ë‹¨ê³„ 2: í•µì‹¬ ì •ë³´ì™€ ê²°ì •ì‚¬í•­ ì¶”ì¶œ
ë‹¨ê³„ 3: ë¶€ìˆ˜ì  ì •ë³´ ì œê±°
ë‹¨ê³„ 4: ê°„ê²°í•œ ë¬¸ì¥ìœ¼ë¡œ ì •ë¦¬

ëŒ€í™”:
{dialogue}

ìµœì¢… ìš”ì•½:
```

---

### 4. ëŒ€í™” ê¸¸ì´ë³„ í…œí”Œë¦¿ (3ê°œ)

ë‹¨ì–´ ìˆ˜ì— ë”°ë¼ ìµœì í™”ëœ í…œí”Œë¦¿

| í…œí”Œë¦¿ ì´ë¦„ | ê¸¸ì´ ë²”ìœ„ | íŠ¹ì§• |
|-----------|---------|------|
| short_dialogue | < 200 ë‹¨ì–´ | í•µì‹¬ë§Œ ê°„ë‹¨íˆ |
| medium_dialogue | 200-500 ë‹¨ì–´ | 3-4ë¬¸ì¥ ìš”ì•½ |
| long_dialogue | > 500 ë‹¨ì–´ | ì£¼ì œë³„ êµ¬ì¡°í™” |

---

### 5. ì°¸ì—¬ì ìˆ˜ë³„ í…œí”Œë¦¿ (3ê°œ)

ì°¸ì—¬ì ìˆ˜ì— ë”°ë¼ ìµœì í™”ëœ í…œí”Œë¦¿

| í…œí”Œë¦¿ ì´ë¦„ | ì°¸ì—¬ì ìˆ˜ | ì´ˆì  |
|-----------|---------|------|
| two_speakers | 2ëª… | ê°ìì˜ ì…ì¥ê³¼ í•©ì˜ì  |
| group_small | 3-4ëª… | ì£¼ìš” ì˜ê²¬ê³¼ ê²°ë¡  |
| group_large | 5ëª… ì´ìƒ | í•µì‹¬ ì£¼ì œì™€ ê²°ì •ì‚¬í•­ |

---

### 6. ì••ì¶• í…œí”Œë¦¿ (2ê°œ)

í† í° ì ˆì•½ì„ ìœ„í•œ ìµœì†Œí™” í…œí”Œë¦¿

| í…œí”Œë¦¿ ì´ë¦„ | ì••ì¶•ë¥  | ì‚¬ìš© ì‹œê¸° |
|-----------|--------|---------|
| compressed_minimal | ìµœëŒ€ | í† í° 80% ì´ìƒ ì‚¬ìš© |
| compressed_concise | ë†’ìŒ | í† í° 60-80% ì‚¬ìš© |

**ì˜ˆì‹œ: compressed_minimal**
```
{dialogue}

ìš”ì•½:
```

---

## ğŸ’» ì‚¬ìš© ë°©ë²•

### 1. ê¸°ë³¸ ì‚¬ìš© (ìë™ ì„ íƒ)

```python
from src.prompts import create_prompt_library, create_prompt_selector

# ì´ˆê¸°í™”
library = create_prompt_library()
selector = create_prompt_selector(library)

# ëŒ€í™” ì¤€ë¹„
dialogue = "#Person1#: ì•ˆë…•í•˜ì„¸ìš”. ì˜¤ëŠ˜ íšŒì˜ ì‹œê°„ì„ ì •í•˜ë ¤ê³  í•©ë‹ˆë‹¤. #Person2#: 3ì‹œëŠ” ì–´ë– ì„¸ìš”?"

# ìë™ ì„ íƒ ë° í¬ë§·íŒ…
template = selector.select_adaptive(dialogue)
prompt = template.format(dialogue=dialogue)

print(f"ì„ íƒëœ í…œí”Œë¦¿: {template.name}")
print(f"í”„ë¡¬í”„íŠ¸:\n{prompt}")
```

---

### 2. ê¸¸ì´ ê¸°ë°˜ ì„ íƒ

```python
# ì§§ì€ ëŒ€í™”
short_dialogue = "A: ì•ˆë…• B: ì•ˆë…•"
template = selector.select_by_length(short_dialogue)
# â†’ short_dialogue í…œí”Œë¦¿

# ê¸´ ëŒ€í™”
long_text = " ".join(["ëŒ€í™” ë‚´ìš©"] * 300)
template = selector.select_by_length(long_text)
# â†’ long_dialogue í…œí”Œë¦¿
```

---

### 3. í† í° ì˜ˆì‚° ì œí•œ

```python
# í† í° ì˜ˆì‚° 500
template = selector.select_by_token_budget(dialogue, token_budget=500)

# ëŒ€í™”ê°€ 400í† í° ì´ìƒì´ë©´ â†’ compressed_minimal
# ëŒ€í™”ê°€ 300-400í† í°ì´ë©´ â†’ compressed_concise
# ëŒ€í™”ê°€ 300í† í° ë¯¸ë§Œì´ë©´ â†’ zero_shot_detailed
```

---

### 4. Few-shot í”„ë¡¬í”„íŠ¸ ìƒì„±

```python
# Few-shot ì˜ˆì‹œ ì¤€ë¹„
example1_dialogue = "A: ì ì‹¬ ë­ ë¨¹ì„ê¹Œ? B: ê¹€ì¹˜ì°Œê°œ ì–´ë•Œ?"
example1_summary = "ì ì‹¬ ë©”ë‰´ ìƒì˜"

example2_dialogue = "A: ë‚´ì¼ íšŒì˜ ì‹œê°„ì€? B: ì˜¤í›„ 3ì‹œ"
example2_summary = "íšŒì˜ ì‹œê°„ ê²°ì •"

# 2-shot í…œí”Œë¦¿ ì‚¬ìš©
template = library.get_template('few_shot_2shot')
prompt = template.format(
    example1_dialogue=example1_dialogue,
    example1_summary=example1_summary,
    example2_dialogue=example2_dialogue,
    example2_summary=example2_summary,
    dialogue=dialogue
)
```

---

### 5. Solar APIì™€ í†µí•©

```python
from src.api import SolarAPI
from src.prompts import create_prompt_selector

# ì´ˆê¸°í™”
api = SolarAPI()
selector = create_prompt_selector()

# ëŒ€í™” ì¤€ë¹„
dialogue = "#Person1#: ì•ˆë…•í•˜ì„¸ìš” #Person2#: ì•ˆë…•í•˜ì„¸ìš”"

# í”„ë¡¬í”„íŠ¸ ìë™ ì„ íƒ
template = selector.select_adaptive(
    dialogue=dialogue,
    token_budget=512,
    prefer_category="zero_shot"
)

# í”„ë¡¬í”„íŠ¸ ìƒì„±
prompt = template.format(dialogue=dialogue)

# API í˜¸ì¶œ
summary = api.summarize(
    dialogue=dialogue,
    custom_prompt=prompt  # ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ ì‚¬ìš©
)

print(f"ìš”ì•½: {summary}")
```

---

### 6. ëŒ€í™” ë¶„ì„ ë° ì¶”ì²œ

```python
# ëŒ€í™” ë¶„ì„
info = selector.get_selection_info(dialogue)

print(f"=== ëŒ€í™” ë¶„ì„ ===")
print(f"ë‹¨ì–´ ìˆ˜: {info['word_count']}")
print(f"ì°¸ì—¬ì ìˆ˜: {info['num_speakers']}")
print(f"ì¶”ì • í† í°: {info['estimated_tokens']}")

print(f"\n=== ì¶”ì²œ í…œí”Œë¦¿ ===")
for criterion, template_name in info['recommendations'].items():
    print(f"{criterion}: {template_name}")

print(f"\n=== ëŒ€í™” íŠ¹ì„± ===")
for char, value in info['characteristics'].items():
    print(f"{char}: {value}")
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
=== ëŒ€í™” ë¶„ì„ ===
ë‹¨ì–´ ìˆ˜: 9
ì°¸ì—¬ì ìˆ˜: 2
ì¶”ì • í† í°: 17

=== ì¶”ì²œ í…œí”Œë¦¿ ===
by_length: short_dialogue
by_speakers: two_speakers
by_token_budget: zero_shot_detailed

=== ëŒ€í™” íŠ¹ì„± ===
is_short: True
is_long: False
is_two_person: True
is_group: False
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ íŒŒì¼ ìœ„ì¹˜
```
src/tests/test_prompts.py
```

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
python src/tests/test_prompts.py
```

### í…ŒìŠ¤íŠ¸ í•­ëª© (ì´ 9ê°œ)

1. âœ… PromptTemplate í´ë˜ìŠ¤
2. âœ… PromptLibrary ì´ˆê¸°í™”
3. âœ… PromptLibrary ê¸°ëŠ¥
4. âœ… ê¸¸ì´ ê¸°ë°˜ ì„ íƒ
5. âœ… ì°¸ì—¬ì ìˆ˜ ê¸°ë°˜ ì„ íƒ
6. âœ… í† í° ì˜ˆì‚° ê¸°ë°˜ ì„ íƒ
7. âœ… ì ì‘í˜• ì„ íƒ
8. âœ… ëŒ€í™” ë¶„ì„ ì •ë³´
9. âœ… í¸ì˜ ìƒì„± í•¨ìˆ˜

**ê²°ê³¼:** 9/9 í…ŒìŠ¤íŠ¸ í†µê³¼ (100%)

---

## ğŸ“Š ì„ íƒ ì „ëµ ë¹„êµ

### ê¸¸ì´ ì„ê³„ê°’

| ë‹¨ì–´ ìˆ˜ | ì„ íƒ í…œí”Œë¦¿ | íŠ¹ì§• |
|--------|-----------|------|
| < 200 | short_dialogue | ê°„ë‹¨í•œ ì§€ì‹œ |
| 200-500 | medium_dialogue | í‘œì¤€ ì§€ì‹œ |
| > 500 | long_dialogue | êµ¬ì¡°í™” ì§€ì‹œ |

### í† í° ì˜ˆì‚° ì „ëµ

| ëŒ€í™” í† í°/ì˜ˆì‚° ë¹„ìœ¨ | ì„ íƒ í…œí”Œë¦¿ | í”„ë¡¬í”„íŠ¸ ê¸¸ì´ |
|-------------------|-----------|-------------|
| > 80% | compressed_minimal | ìµœì†Œ |
| 60-80% | compressed_concise | ê°„ê²° |
| < 60% | zero_shot_detailed | ìƒì„¸ |

### ì°¸ì—¬ì ìˆ˜ ì „ëµ

| ì°¸ì—¬ì ìˆ˜ | ì„ íƒ í…œí”Œë¦¿ | ì´ˆì  |
|---------|-----------|------|
| 2ëª… | two_speakers | ì–‘ì ê´€ê³„ |
| 3-4ëª… | group_small | ì†Œê·¸ë£¹ ì—­í•™ |
| 5ëª…+ | group_large | ì£¼ìš” ê²°ì •ì‚¬í•­ |

---

## âš™ï¸ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### 1. ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ì¶”ê°€

```python
from src.prompts import PromptTemplate, PromptLibrary

library = PromptLibrary()

# ì»¤ìŠ¤í…€ í…œí”Œë¦¿ ì •ì˜
custom_template = PromptTemplate(
    name="business_summary",
    template="""ë‹¤ìŒì€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ… ëŒ€í™”ì…ë‹ˆë‹¤.

ê²°ì •ì‚¬í•­ê³¼ ì•¡ì…˜ ì•„ì´í…œì„ ì¤‘ì‹¬ìœ¼ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”.

ëŒ€í™”:
{dialogue}

ê²°ì •ì‚¬í•­:
ì•¡ì…˜ ì•„ì´í…œ:
ìš”ì•½:""",
    description="ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ… ì „ìš© í…œí”Œë¦¿",
    category="domain_specific",
    variables=["dialogue"]
)

# ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì¶”ê°€
library.add_template(custom_template)

# ì‚¬ìš©
template = library.get_template('business_summary')
prompt = template.format(dialogue="...")
```

---

### 2. ì»¤ìŠ¤í…€ ì„ íƒ ë¡œì§

```python
class CustomPromptSelector(PromptSelector):
    """ì»¤ìŠ¤í…€ ì„ íƒ ë¡œì§"""

    def select_by_topic(self, dialogue: str, topic: str) -> PromptTemplate:
        """ì£¼ì œë³„ í…œí”Œë¦¿ ì„ íƒ"""

        topic_mapping = {
            'ë¹„ì¦ˆë‹ˆìŠ¤': 'business_summary',
            'ì¼ìƒ': 'casual_summary',
            'ê¸°ìˆ ': 'technical_summary'
        }

        template_name = topic_mapping.get(topic, 'zero_shot_basic')
        return self.library.get_template(template_name)

# ì‚¬ìš©
selector = CustomPromptSelector()
template = selector.select_by_topic(dialogue, topic='ë¹„ì¦ˆë‹ˆìŠ¤')
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ë³€ìˆ˜ ëˆ„ë½

**ë¬¸ì œ:** í…œí”Œë¦¿ í¬ë§·íŒ… ì‹œ í•„ìˆ˜ ë³€ìˆ˜ ëˆ„ë½

```python
template = library.get_template('few_shot_2shot')

# âŒ ì—ëŸ¬ ë°œìƒ
prompt = template.format(dialogue="test")  # example ë³€ìˆ˜ ëˆ„ë½

# âœ… ì˜¬ë°”ë¥¸ ì‚¬ìš©
prompt = template.format(
    example1_dialogue="...",
    example1_summary="...",
    example2_dialogue="...",
    example2_summary="...",
    dialogue="test"
)
```

---

### 2. í† í° ì˜ˆì‚° ì´ˆê³¼

**ë¬¸ì œ:** í”„ë¡¬í”„íŠ¸ + ëŒ€í™”ê°€ í† í° ì˜ˆì‚° ì´ˆê³¼

```python
# í† í° ì˜ˆì‚° ì²´í¬
dialogue_tokens = selector._estimate_tokens(dialogue)
prompt_tokens = library.estimate_tokens(template_name, dialogue=dialogue)
total_tokens = dialogue_tokens + prompt_tokens

if total_tokens > token_budget:
    # ì••ì¶• í…œí”Œë¦¿ìœ¼ë¡œ ì „í™˜
    template = selector.select_by_token_budget(dialogue, token_budget)
```

---

### 3. Few-shot ì˜ˆì‹œ ì„ íƒ

**ê¶Œì¥ ì‚¬í•­:**
- íƒ€ê²Ÿ ëŒ€í™”ì™€ ìœ ì‚¬í•œ ê¸¸ì´ì˜ ì˜ˆì‹œ ì‚¬ìš©
- ë‹¤ì–‘í•œ íŒ¨í„´ í¬í•¨ (ì§§ì€/ê¸´, 2ì¸/ë‹¤ì¸)
- ê³ í’ˆì§ˆ ìš”ì•½ ì˜ˆì‹œ ì‚¬ìš©

```python
# âœ… ì¢‹ì€ ì˜ˆì‹œ ì„ íƒ
example1 = get_example_by_similarity(dialogue, top_k=1)
example2 = get_example_by_diversity(dialogue, examples)

# âŒ ë‚˜ìœ ì˜ˆì‹œ ì„ íƒ
example1 = train_data[0]  # ë¬´ì‘ìœ„ ì„ íƒ
example2 = train_data[1]  # ë‹¤ì–‘ì„± ì—†ìŒ
```

---

## ğŸ“ˆ ì„±ëŠ¥ í–¥ìƒ íŒ

### 1. í…œí”Œë¦¿ ì„ íƒ ìš°ì„ ìˆœìœ„

1. **í† í° ì˜ˆì‚°ì´ ì œí•œì ì¸ ê²½ìš°** â†’ token_budget ê¸°ë°˜ ì„ íƒ
2. **Few-shot ì˜ˆì‹œê°€ ìˆëŠ” ê²½ìš°** â†’ few_shot í…œí”Œë¦¿
3. **ë³µì¡í•œ ëŒ€í™”ì¸ ê²½ìš°** â†’ CoT í…œí”Œë¦¿
4. **ê¸°ë³¸ ê²½ìš°** â†’ ê¸¸ì´ ê¸°ë°˜ ì„ íƒ

```python
def smart_select(dialogue, examples=None, token_budget=None):
    if token_budget and is_tight_budget(dialogue, token_budget):
        return selector.select_by_token_budget(dialogue, token_budget)
    elif examples:
        return selector.select_by_category('few_shot', dialogue, num_examples=len(examples))
    elif is_complex(dialogue):
        return selector.select_by_category('cot', dialogue)
    else:
        return selector.select_by_length(dialogue)
```

---

### 2. í”„ë¡¬í”„íŠ¸ ì••ì¶• ì „ëµ

```python
# 1. Person íƒœê·¸ ê°„ì†Œí™”
dialogue = dialogue.replace('#Person1#:', 'A:')
dialogue = dialogue.replace('#Person2#:', 'B:')

# 2. ê³µë°± ì œê±°
dialogue = ' '.join(dialogue.split())

# 3. ì••ì¶• í…œí”Œë¦¿ ì‚¬ìš©
template = selector.select_by_token_budget(dialogue, token_budget)
```

---

### 3. ë™ì  Few-shot ì˜ˆì‹œ ì„ íƒ

```python
from sklearn.metrics.pairwise import cosine_similarity
from transformers import AutoTokenizer, AutoModel

def select_few_shot_examples(dialogue, train_data, n_examples=2):
    """ìœ ì‚¬ë„ ê¸°ë°˜ Few-shot ì˜ˆì‹œ ì„ íƒ"""

    # ì„ë² ë”© ê³„ì‚°
    target_embedding = get_embedding(dialogue)
    train_embeddings = [get_embedding(ex['dialogue']) for ex in train_data]

    # ìœ ì‚¬ë„ ê³„ì‚°
    similarities = cosine_similarity([target_embedding], train_embeddings)[0]

    # Top-k ì„ íƒ
    top_indices = similarities.argsort()[-n_examples:][::-1]

    return [train_data[i] for i in top_indices]
```

---

## ğŸ”— ê´€ë ¨ íŒŒì¼

**ì†ŒìŠ¤ ì½”ë“œ:**
- `src/prompts/template.py` - PromptTemplate ë° PromptLibrary
- `src/prompts/selector.py` - PromptSelector
- `src/prompts/__init__.py` - íŒ¨í‚¤ì§€ ì´ˆê¸°í™”

**í…ŒìŠ¤íŠ¸:**
- `src/tests/test_prompts.py` - í”„ë¡¬í”„íŠ¸ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸

**ë¬¸ì„œ:**
- `docs/PRD/15_í”„ë¡¬í”„íŠ¸_ì—”ì§€ë‹ˆì–´ë§_ì „ëµ.md` - PRD ë¬¸ì„œ
- `docs/ëª¨ë“ˆí™”/00_ì „ì²´_ì‹œìŠ¤í…œ_ê°œìš”.md` - ì‹œìŠ¤í…œ ê°œìš”

---

## ğŸ“š ì°¸ê³  ìë£Œ

**í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê°€ì´ë“œ:**
- OpenAI Prompt Engineering Guide
- Anthropic Prompt Design Guide

**Few-shot Learning:**
- Brown et al. (2020) "Language Models are Few-Shot Learners"

**Chain-of-Thought:**
- Wei et al. (2022) "Chain-of-Thought Prompting Elicits Reasoning"

**í† í° ìµœì í™”:**
- Prompt compression techniques
- Token-efficient prompting strategies
