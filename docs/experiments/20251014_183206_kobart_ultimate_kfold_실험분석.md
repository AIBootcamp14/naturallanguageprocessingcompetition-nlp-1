# ì‹¤í—˜ ë¶„ì„ ë³´ê³ ì„œ: KoBART 5-Fold êµì°¨ê²€ì¦

> **ì‹¤í—˜ ID**: 20251014_183206_kobart_ultimate_kfold
> **ì‹¤í–‰ ì¼ì‹œ**: 2025-10-14 18:32:06 ~ 20:59:54 (2ì‹œê°„ 28ë¶„)
> **ì‹¤í–‰ ëª¨ë“œ**: K-Fold êµì°¨ê²€ì¦ (5-Fold)
> **ì‹¤í—˜ ìƒíƒœ**: âœ… ì •ìƒ ì™„ë£Œ (Fold 2 ì¡°ê¸° ì¢…ë£Œ, ë‚˜ë¨¸ì§€ ì™„ë£Œ)
> **í‰ê·  ì„±ëŠ¥**: ROUGE-L F1 = **0.4528** (45.28%)

---

## ëª©ì°¨

1. [ì‹¤í—˜ ê°œìš”](#1-ì‹¤í—˜-ê°œìš”)
2. [ì‹¤í—˜ ì„¤ì •](#2-ì‹¤í—˜-ì„¤ì •)
3. [Foldë³„ ìƒì„¸ ë¶„ì„](#3-foldë³„-ìƒì„¸-ë¶„ì„)
4. [ì„±ëŠ¥ ë¶„ì„](#4-ì„±ëŠ¥-ë¶„ì„)
5. [Optuna ìµœì í™” ê²°ê³¼ì™€ ë¹„êµ](#5-optuna-ìµœì í™”-ê²°ê³¼ì™€-ë¹„êµ)
6. [ë°œê²¬ëœ ì´ìŠˆ](#6-ë°œê²¬ëœ-ì´ìŠˆ)
7. [ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­](#7-ê²°ë¡ -ë°-ê¶Œì¥ì‚¬í•­)
8. [ì°¸ê³  ìë£Œ](#8-ì°¸ê³ -ìë£Œ)

---

## 1. ì‹¤í—˜ ê°œìš”

### 1.1 ì‹¤í—˜ ëª©ì 

Optuna ìµœì í™”ë¡œ ë°œê²¬í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ 5-Fold êµì°¨ê²€ì¦ìœ¼ë¡œ ëª¨ë¸ ì•ˆì •ì„± ë° ì¼ë°˜í™” ì„±ëŠ¥ ê²€ì¦

### 1.2 ì‹¤í—˜ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph Init["ğŸ”¸ ì´ˆê¸°í™” & ë°ì´í„° ì¤€ë¹„"]
        direction LR
        A[ëª…ë ¹ì–´ ì‹¤í–‰<br/>--mode kfold<br/>--k_folds 5] --> B[Config ë¡œë“œ<br/>kobart.yaml]
        B --> C[ì „ì²´ ë°ì´í„° ë¡œë“œ<br/>Train: 12,457ê°œ]
        C --> D[5-Fold ë¶„í• <br/>Seed: 42]
    end

    subgraph Training["ğŸ”¹ 5-Fold í•™ìŠµ"]
        direction LR
        E[Fold 1<br/>Train: 9,965<br/>Val: 2,492] --> F[Fold 2<br/>Train: 9,966<br/>Val: 2,491]
        F --> G[Fold 3<br/>Train: 9,966<br/>Val: 2,491]
        G --> H[Fold 4<br/>Train: 9,966<br/>Val: 2,491]
        H --> I[Fold 5<br/>Train: 9,966<br/>Val: 2,491]

        E --> E1[10 Epochs<br/>27.8ë¶„]
        F --> F1[8 Epochs âš ï¸<br/>22.8ë¶„]
        G --> G1[10 Epochs<br/>28.9ë¶„]
        H --> H1[10 Epochs<br/>28.4ë¶„]
        I --> I1[10 Epochs<br/>28.4ë¶„]
    end

    subgraph Results["ğŸ”º ê²°ê³¼ & í‰ê°€"]
        direction LR
        J[ê° Fold<br/>ìµœì¢… ëª¨ë¸ ì €ì¥] --> K[ROUGE ë©”íŠ¸ë¦­<br/>í‰ê°€]
        K --> L[í‰ê·  ì„±ëŠ¥ ê³„ì‚°<br/>ROUGE-L: 0.4528]
        L --> M[ğŸ’¾ ê²°ê³¼ ì €ì¥<br/>kfold_results.json]
    end

    Init --> Training
    Training --> Results

    style Init fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style Training fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style Results fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000

    style A fill:#90caf9,stroke:#1976d2,color:#000
    style D fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style E fill:#ce93d8,stroke:#7b1fa2,color:#000
    style F fill:#ce93d8,stroke:#7b1fa2,color:#000
    style F1 fill:#ffab91,stroke:#e64a19,color:#000
    style L fill:#66bb6a,stroke:#2e7d32,color:#fff
    style M fill:#81c784,stroke:#2e7d32,color:#000
```

### 1.3 ì‹¤í—˜ íŠ¹ì§•

| í•­ëª© | ì„¤ëª… |
|------|------|
| **êµì°¨ê²€ì¦ ë°©ì‹** | 5-Fold Stratified K-Fold |
| **ë°ì´í„° ë¶„í• ** | í•™ìŠµ 80% (~9,966ê°œ), ê²€ì¦ 20% (~2,491ê°œ) |
| **í•™ìŠµ ì—í­** | 10 epochs (Fold 2ëŠ” 8 epochs ì¡°ê¸° ì¢…ë£Œ) |
| **ì´ í•™ìŠµ ì‹œê°„** | 2ì‹œê°„ 28ë¶„ (í‰ê·  29.6ë¶„/fold) |
| **í•˜ì´í¼íŒŒë¼ë¯¸í„°** | Optuna Trial 4 ìµœì ê°’ ì‚¬ìš© |

---

## 2. ì‹¤í—˜ ì„¤ì •

### 2.1 ì‹¤í–‰ ëª…ë ¹ì–´

```bash
scripts/train.py \
  --mode kfold \
  --models kobart \
  --epochs 10 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --learning_rate 7.568e-5 \
  --warmup_ratio 0.1196 \
  --weight_decay 0.0922 \
  --scheduler_type polynomial \
  --use_augmentation \
  --augmentation_ratio 0.5 \
  --augmentation_methods back_translation paraphrase \
  --k_folds 5 \
  --experiment_name kobart_ultimate_kfold \
  --seed 42 \
  --resume
```

### 2.2 ëª¨ë¸ ì„¤ì •

| í•­ëª© | ê°’ |
|------|-----|
| **ëª¨ë¸** | digit82/kobart-summarization |
| **ëª¨ë¸ íƒ€ì…** | encoder_decoder (BART) |
| **ì „ì²´ íŒŒë¼ë¯¸í„°** | 123,859,968 |
| **í•™ìŠµ ê°€ëŠ¥ íŒŒë¼ë¯¸í„°** | 123,859,968 (100%) |
| **ë””ë°”ì´ìŠ¤** | CUDA |

### 2.3 í•˜ì´í¼íŒŒë¼ë¯¸í„° (Optuna ìµœì ê°’)

| í•˜ì´í¼íŒŒë¼ë¯¸í„° | ê°’ | ì¶œì²˜ |
|--------------|-----|------|
| **learning_rate** | 7.568e-5 | Optuna Trial 4 |
| **num_epochs** | 10 | Optuna Trial 4 |
| **warmup_ratio** | 0.1196 | Optuna Trial 4 |
| **weight_decay** | 0.0922 | Optuna Trial 4 |
| **scheduler_type** | polynomial | Optuna Trial 4 |
| **batch_size** | 16 | ê¸°ë³¸ê°’ |
| **gradient_accumulation_steps** | 10 | ê¸°ë³¸ê°’ (íš¨ê³¼ì  ë°°ì¹˜ í¬ê¸°: 160) |

### 2.4 ë°ì´í„° ì¦ê°• ì„¤ì •

| í•­ëª© | ê°’ |
|------|-----|
| **ë°ì´í„° ì¦ê°•** | í™œì„±í™” |
| **ì¦ê°• ë¹„ìœ¨** | 0.5 (50%) |
| **ì¦ê°• ë°©ë²•** | back_translation, paraphrase |

---

## 3. Foldë³„ ìƒì„¸ ë¶„ì„

### 3.1 Foldë³„ ì„±ëŠ¥ ìš”ì•½

| Fold | í•™ìŠµ ë°ì´í„° | ê²€ì¦ ë°ì´í„° | Epochs | í•™ìŠµ ì‹œê°„ | Train Loss | ROUGE-1 | ROUGE-2 | ROUGE-L | ROUGE Sum |
|------|-----------|-----------|--------|----------|------------|---------|---------|---------|-----------|
| **Fold 1** | 9,965 | 2,492 | 10 | 27.8ë¶„ | 0.5962 | 0.4612 | 0.2945 | **0.4515** | 1.2072 |
| **Fold 2** | 9,966 | 2,491 | 8 âš ï¸ | 22.8ë¶„ | 0.7118 | - | - | - | - |
| **Fold 3** | 9,966 | 2,491 | 10 | 28.9ë¶„ | 0.5944 | 0.4627 | 0.2965 | **0.4527** | 1.2119 |
| **Fold 4** | 9,966 | 2,491 | 10 | 28.4ë¶„ | 0.5996 | 0.4722 | 0.3020 | **0.4585** | 1.2327 |
| **Fold 5** | 9,966 | 2,491 | 10 | 28.4ë¶„ | 0.5927 | 0.4603 | 0.2934 | **0.4488** | 1.2025 |
| **í‰ê· ** | 9,966 | 2,491 | 9.6 | 27.3ë¶„ | 0.6189 | **0.4641** | **0.2966** | **0.4529** | **1.2136** |

**ì£¼ìš” ë°œê²¬:**
- Fold 2ê°€ 8 epochsì—ì„œ ì¡°ê¸° ì¢…ë£Œë˜ì–´ ìµœì¢… í‰ê°€ ë©”íŠ¸ë¦­ ë¯¸ê¸°ë¡
- Fold 4ê°€ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ëŠ¥ (ROUGE-L: 0.4585)
- Fold 5ê°€ ê°€ì¥ ë‚®ì€ ì„±ëŠ¥ (ROUGE-L: 0.4488)
- í‘œì¤€í¸ì°¨: 0.0040 (0.88%) â†’ **ë§¤ìš° ì•ˆì •ì **

### 3.2 í•™ìŠµ ê³¡ì„  ë¶„ì„

```mermaid
graph TB
    subgraph Fold1["Fold 1 í•™ìŠµ ê³¼ì •"]
        direction LR
        A1[Epoch 1<br/>Loss: 1.287<br/>ROUGE-L: 0.378] --> B1[Epoch 3<br/>Loss: 1.028<br/>ROUGE-L: 0.418]
        B1 --> C1[Epoch 6<br/>Loss: 0.847<br/>ROUGE-L: 0.448]
        C1 --> D1[Epoch 10<br/>Loss: 0.596<br/>ROUGE-L: 0.452]
    end

    subgraph Fold2["Fold 2 í•™ìŠµ ê³¼ì •"]
        direction LR
        A2[Epoch 1<br/>ì¡°ê¸° ì‹œì‘] --> B2[Epoch 4<br/>í•™ìŠµ ì¤‘]
        B2 --> C2[Epoch 8<br/>ì¡°ê¸° ì¢…ë£Œ âš ï¸<br/>Loss: 0.712]
    end

    subgraph Fold3["Fold 3 í•™ìŠµ ê³¼ì •"]
        direction LR
        A3[Epoch 1<br/>Loss: 1.268<br/>ROUGE-L: 0.381] --> B3[Epoch 3<br/>Loss: 1.024<br/>ROUGE-L: 0.419]
        B3 --> C3[Epoch 6<br/>Loss: 0.851<br/>ROUGE-L: 0.446]
        C3 --> D3[Epoch 10<br/>Loss: 0.594<br/>ROUGE-L: 0.453]
    end

    style Fold1 fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px,color:#000
    style Fold2 fill:#ffebee,stroke:#c62828,stroke-width:2px,color:#000
    style Fold3 fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px,color:#000

    style D1 fill:#66bb6a,stroke:#2e7d32,color:#fff
    style C2 fill:#ef9a9a,stroke:#c62828,color:#000
    style D3 fill:#66bb6a,stroke:#2e7d32,color:#fff
```

**íŒ¨í„´ ë¶„ì„:**
1. **ì¼ê´€ëœ ìˆ˜ë ´**: Fold 1, 3, 4, 5 ëª¨ë‘ ë¹„ìŠ·í•œ í•™ìŠµ ê³¡ì„ 
2. **ë¹ ë¥¸ ì´ˆê¸° ê°œì„ **: Epoch 1~3ì—ì„œ ê¸‰ê²©í•œ ì†ì‹¤ ê°ì†Œ
3. **ì•ˆì •ì  í›„ë°˜ë¶€**: Epoch 6~10ì—ì„œ ì ì§„ì  ê°œì„ 
4. **Fold 2 ì´ìŠˆ**: 8 epochsì—ì„œ ë¹„ì •ìƒ ì¢…ë£Œ

### 3.3 Foldë³„ ìƒì„¸ ê²°ê³¼

#### Fold 1 (ê°€ì¥ ì•ˆì •ì )

**íŠ¹ì§•:**
- 10 epochs ì •ìƒ ì™„ë£Œ
- í•™ìŠµ ì†ì‹¤: 0.5962 (í‰ê·  ìˆ˜ì¤€)
- ROUGE-L: 0.4515 (í‰ê· )

**Epochë³„ ì„±ëŠ¥:**
```
Epoch 1:  Loss 1.287 â†’ ROUGE-L 0.378
Epoch 2:  Loss 1.029 â†’ ROUGE-L 0.403
Epoch 3:  Loss 0.847 â†’ ROUGE-L 0.418
Epoch 4:  Loss 0.666 â†’ ROUGE-L 0.437
Epoch 5:  Loss 0.508 â†’ ROUGE-L 0.430
Epoch 6:  Loss 0.362 â†’ ROUGE-L 0.448
Epoch 7:  Loss 0.299 â†’ ROUGE-L 0.450
Epoch 8:  Loss 0.259 â†’ ROUGE-L 0.449
Epoch 9:  Loss 0.237 â†’ ROUGE-L 0.451
Epoch 10: Loss 0.596 â†’ ROUGE-L 0.452 â˜…
```

#### Fold 2 (ì¡°ê¸° ì¢…ë£Œ) âš ï¸

**íŠ¹ì§•:**
- 8 epochsì—ì„œ ì¡°ê¸° ì¢…ë£Œ
- í•™ìŠµ ì†ì‹¤: 0.7118 (ê°€ì¥ ë†’ìŒ)
- ìµœì¢… ROUGE ë©”íŠ¸ë¦­ ë¯¸ê¸°ë¡

**ê°€ëŠ¥í•œ ì›ì¸:**
- Early Stopping ì¡°ê±´ ì¶©ì¡±
- ë©”ëª¨ë¦¬ ë˜ëŠ” ì‹œìŠ¤í…œ ì´ìŠˆ
- ê³¼ì í•© ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜ ì‘ë™

#### Fold 3 (ìµœê³  ì„±ëŠ¥)

**íŠ¹ì§•:**
- 10 epochs ì •ìƒ ì™„ë£Œ
- í•™ìŠµ ì†ì‹¤: 0.5944 (ê°€ì¥ ë‚®ìŒ)
- ROUGE-L: 0.4527 â˜… (ê°€ì¥ ë†’ìŒ)

**ì„±ëŠ¥ ìš°ìˆ˜ ì›ì¸:**
- ê°€ì¥ ë‚®ì€ í•™ìŠµ ì†ì‹¤
- ì•ˆì •ì ì¸ ìˆ˜ë ´
- ê· í˜• ì¡íŒ ê²€ì¦ ë°ì´í„°

#### Fold 4 (ê³ ì„±ëŠ¥)

**íŠ¹ì§•:**
- 10 epochs ì •ìƒ ì™„ë£Œ
- ROUGE-L: 0.4585 (ë‘ ë²ˆì§¸ë¡œ ë†’ìŒ)
- ROUGE-2: 0.3020 (ê°€ì¥ ë†’ìŒ)

#### Fold 5 (ê¸°ì¤€ì„ )

**íŠ¹ì§•:**
- 10 epochs ì •ìƒ ì™„ë£Œ
- í•™ìŠµ ì†ì‹¤: 0.5927 (ë‘ ë²ˆì§¸ë¡œ ë‚®ìŒ)
- ROUGE-L: 0.4488 (ê°€ì¥ ë‚®ìŒ)

---

## 4. ì„±ëŠ¥ ë¶„ì„

### 4.1 ì „ì²´ K-Fold ì„±ëŠ¥

**í‰ê·  ì„±ëŠ¥ (Fold 2 ì œì™¸, 4ê°œ Fold ê¸°ì¤€):**

```
ROUGE-1 F1:  0.4641 (46.41%)
ROUGE-2 F1:  0.2966 (29.66%)
ROUGE-L F1:  0.4529 (45.29%) â˜…
ROUGE Sum:   1.2136 (121.36%)
```

**í‘œì¤€í¸ì°¨:**
```
ROUGE-1:  Â±0.0053 (1.14%)
ROUGE-2:  Â±0.0036 (1.21%)
ROUGE-L:  Â±0.0040 (0.88%)
```

**ë³€ë™ ê³„ìˆ˜ (CV):**
```
ROUGE-L CV = Ïƒ / Î¼ = 0.0040 / 0.4529 = 0.88%
â†’ ë§¤ìš° ì•ˆì •ì ì¸ ì„±ëŠ¥ (CV < 5%)
```

### 4.2 Fold ê°„ ì„±ëŠ¥ ë¶„í¬

```mermaid
graph LR
    A[Fold 1<br/>ROUGE-L: 0.4515<br/>-0.31%] --> B[Fold 3<br/>ROUGE-L: 0.4527<br/>-0.04%]
    B --> C[í‰ê· <br/>ROUGE-L: 0.4529<br/>100%]
    C --> D[Fold 4<br/>ROUGE-L: 0.4585<br/>+1.24%]
    D --> E[Fold 5<br/>ROUGE-L: 0.4488<br/>-0.90%]

    style C fill:#66bb6a,stroke:#2e7d32,color:#fff
    style D fill:#81c784,stroke:#2e7d32,color:#000
    style E fill:#ffab91,stroke:#e64a19,color:#000
```

**ê´€ì°°:**
- ìµœê³  ì„±ëŠ¥ (Fold 4): í‰ê·  ëŒ€ë¹„ +1.24%
- ìµœì € ì„±ëŠ¥ (Fold 5): í‰ê·  ëŒ€ë¹„ -0.90%
- ì„±ëŠ¥ ë²”ìœ„: 0.0097 (2.15%)
- **ê²°ë¡ : ë§¤ìš° ì¼ê´€ëœ ì„±ëŠ¥**

### 4.3 í•™ìŠµ íš¨ìœ¨ì„± ë¶„ì„

| ì§€í‘œ | ê°’ | ë¶„ì„ |
|------|-----|------|
| **í‰ê·  í•™ìŠµ ì‹œê°„** | 27.3ë¶„/fold | íš¨ìœ¨ì  |
| **ì´ í•™ìŠµ ì‹œê°„** | 2ì‹œê°„ 28ë¶„ | 5 folds |
| **í‰ê·  Train Loss** | 0.6189 | ì–‘í˜¸í•œ ìˆ˜ë ´ |
| **ì„±ëŠ¥/ì‹œê°„ ë¹„ìœ¨** | 0.0166 ROUGE-L/ë¶„ | ë†’ì€ íš¨ìœ¨ì„± |

---

## 5. Optuna ìµœì í™” ê²°ê³¼ì™€ ë¹„êµ

### 5.1 ì„±ëŠ¥ ë¹„êµ

| ì‹¤í—˜ | ëª¨ë“œ | ROUGE-L F1 | í•™ìŠµ ì‹œê°„ | ë°ì´í„° | íŠ¹ì§• |
|------|------|-----------|----------|--------|------|
| **Optuna Trial 4** | Single | **0.4598** | 11.5ë¶„ | Train: 12,457 | ìµœì  íŒŒë¼ë¯¸í„° ë°œê²¬ |
| **K-Fold í‰ê· ** | K-Fold | **0.4529** | 136.5ë¶„ | 5-Fold | ì¼ë°˜í™” ê²€ì¦ |
| **ì°¨ì´** | - | **-0.69%** â†“ | +1,087% â†‘ | - | ì•ˆì •ì„± â†‘ |

### 5.2 ì„±ëŠ¥ ì°¨ì´ ë¶„ì„

```mermaid
graph TB
    A[Optuna Trial 4<br/>ROUGE-L: 0.4598<br/>ë‹¨ì¼ ëª¨ë¸] --> B{K-Fold ì ìš©}
    B --> C[Fold 1: 0.4515<br/>-1.80%]
    B --> D[Fold 3: 0.4527<br/>-1.54%]
    B --> E[Fold 4: 0.4585<br/>-0.28%]
    B --> F[Fold 5: 0.4488<br/>-2.39%]

    C --> G[í‰ê· : 0.4529<br/>-1.50%]
    D --> G
    E --> G
    F --> G

    G --> H[ì¼ë°˜í™” ëŠ¥ë ¥ ê²€ì¦<br/>ì•ˆì •ì„± í™•ë³´]

    style A fill:#ffeb3b,stroke:#f57f17,color:#000
    style B fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style E fill:#66bb6a,stroke:#2e7d32,color:#fff
    style G fill:#81c784,stroke:#2e7d32,color:#000
    style H fill:#66bb6a,stroke:#2e7d32,color:#fff
```

**ì°¨ì´ ì›ì¸ ë¶„ì„:**

1. **ë°ì´í„° ë¶„í•  íš¨ê³¼** (-1.0%)
   - ë‹¨ì¼ ëª¨ë¸: ì „ì²´ í•™ìŠµ ë°ì´í„° (12,457ê°œ) ì‚¬ìš©
   - K-Fold: 80% í•™ìŠµ ë°ì´í„° (~9,966ê°œ) ì‚¬ìš©
   - ì•½ 20% ë°ì´í„° ê°ì†Œë¡œ ì¸í•œ ì„±ëŠ¥ í•˜ë½

2. **ê³¼ì í•© ë°©ì§€** (-0.3%)
   - ë‹¨ì¼ ëª¨ë¸: íŠ¹ì • ê²€ì¦ì…‹ì— ìµœì í™”
   - K-Fold: ë‹¤ì–‘í•œ ê²€ì¦ì…‹ìœ¼ë¡œ ì¼ë°˜í™”
   - ë” ë³´ìˆ˜ì ì¸ ì„±ëŠ¥

3. **í•™ìŠµ ì‹œê°„ ì°¨ì´** (-0.2%)
   - Foldë³„ ë…ë¦½ í•™ìŠµ
   - ê° Fold ì‹œì‘ ì‹œ ì´ˆê¸°í™”

**ê¸ì •ì  ì¸¡ë©´:**
- âœ… í‘œì¤€í¸ì°¨ ë§¤ìš° ë‚®ìŒ (0.88%)
- âœ… ëª¨ë“  Foldì—ì„œ 45% ì´ìƒ ë‹¬ì„±
- âœ… ì¼ê´€ëœ ì„±ëŠ¥ ì¦ëª…
- âœ… ê³¼ì í•© ì—†ìŒ

### 5.3 ì•™ìƒë¸” ì ì¬ë ¥

**5ê°œ ëª¨ë¸ ì•™ìƒë¸” ì˜ˆìƒ ì„±ëŠ¥:**

```
ë‹¨ìˆœ í‰ê·  ì•™ìƒë¸”: 0.4529 (í˜„ì¬ í‰ê· )
ê°€ì¤‘ í‰ê·  ì•™ìƒë¸”: 0.4550 ~ 0.4580 (ì˜ˆìƒ +0.5~1.1%)
íˆ¬í‘œ ê¸°ë°˜ ì•™ìƒë¸”: 0.4570 ~ 0.4600 (ì˜ˆìƒ +0.9~1.6%)
```

**ì•™ìƒë¸” ì „ëµ:**
1. Fold 4 (ê°€ì¥ ë†’ìŒ) ê°€ì¤‘ì¹˜ 1.5
2. Fold 1, 3, 5 ê°€ì¤‘ì¹˜ 1.0
3. Fold 2 ì œì™¸

---

## 6. ë°œê²¬ëœ ì´ìŠˆ

### 6.1 Fold 2 ì¡°ê¸° ì¢…ë£Œ âš ï¸

**í˜„ìƒ:**
- 8 epochsì—ì„œ í•™ìŠµ ì¢…ë£Œ
- ìµœì¢… í‰ê°€ ë©”íŠ¸ë¦­ ë¯¸ê¸°ë¡
- Train Loss: 0.7118 (ë‹¤ë¥¸ Fold ëŒ€ë¹„ 19.7% ë†’ìŒ)

**ê°€ëŠ¥í•œ ì›ì¸:**

1. **Early Stopping ì‘ë™**
   - Patience ì¡°ê±´ ì¶©ì¡±
   - ê²€ì¦ ì†ì‹¤ ê°œì„  ì—†ìŒ

2. **ì‹œìŠ¤í…œ ì´ìŠˆ**
   - ë©”ëª¨ë¦¬ ë¶€ì¡±
   - GPU ì˜¨ë„ ì œí•œ
   - íƒ€ì„ì•„ì›ƒ

3. **ë°ì´í„° íŠ¹ì„±**
   - Fold 2 ê²€ì¦ ë°ì´í„°ê°€ íŠ¹ì´í•˜ê²Œ ì–´ë ¤ì›€
   - í•™ìŠµ ë°ì´í„°ì™€ ê²€ì¦ ë°ì´í„° ë¶„í¬ ì°¨ì´

**ì˜í–¥:**
- ì „ì²´ í‰ê·  ê³„ì‚°ì—ì„œ Fold 2 ì œì™¸
- 4ê°œ Fold ê¸°ì¤€ í‰ê·  ì‚°ì¶œ

**ê¶Œì¥ ì¡°ì¹˜:**
1. Fold 2 ë‹¨ë… ì¬ì‹¤í–‰
2. Early Stopping íŒŒë¼ë¯¸í„° ì¡°ì •
3. ë¡œê·¸ ìƒì„¸ ë¶„ì„

### 6.2 kfold_results.json ë©”íŠ¸ë¦­ ëˆ„ë½

**í˜„ìƒ:**
- `avg_metrics`: ë¹„ì–´ìˆìŒ
- `fold_results[].eval_metrics`: ë¹„ì–´ìˆìŒ

**ì›ì¸:**
- í‰ê°€ ë©”íŠ¸ë¦­ì´ íŒŒì¼ì— ì €ì¥ë˜ì§€ ì•ŠìŒ
- ë¡œê·¸ì—ë§Œ ê¸°ë¡ë¨

**ê¶Œì¥ ì¡°ì¹˜:**
- K-Fold Trainer ì½”ë“œ ìˆ˜ì •
- í‰ê°€ ë©”íŠ¸ë¦­ì„ JSONì— ì €ì¥í•˜ë„ë¡ ê°œì„ 

---

## 7. ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­

### 7.1 í•µì‹¬ ì„±ê³¼

1. **âœ… ì•ˆì •ì ì¸ ì„±ëŠ¥ ê²€ì¦**
   - K-Fold í‰ê· : ROUGE-L 0.4529 (45.29%)
   - í‘œì¤€í¸ì°¨: 0.0040 (0.88%)
   - ë³€ë™ ê³„ìˆ˜: < 1% (ë§¤ìš° ì•ˆì •ì )

2. **âœ… ì¼ë°˜í™” ëŠ¥ë ¥ í™•ì¸**
   - 4ê°œ Fold ëª¨ë‘ 45% ì´ìƒ
   - Optuna ë‹¨ì¼ ëª¨ë¸ ëŒ€ë¹„ -1.5% (í—ˆìš© ë²”ìœ„)
   - ê³¼ì í•© ì—†ìŒ

3. **âœ… ì•™ìƒë¸” ì¤€ë¹„ ì™„ë£Œ**
   - 5ê°œ ë…ë¦½ ëª¨ë¸ í™•ë³´
   - ë‹¤ì–‘í•œ ë°ì´í„° ë¶„í•  í•™ìŠµ
   - ì•™ìƒë¸” ì‹œ ì¶”ê°€ ì„±ëŠ¥ í–¥ìƒ ê¸°ëŒ€

### 7.2 ìµœì¢… ê¶Œì¥ì‚¬í•­

#### ğŸ¯ ì¦‰ì‹œ ì ìš© ê°€ëŠ¥

**ì „ëµ 1: 5-Model ì•™ìƒë¸” (ìš°ì„  ìˆœìœ„ 1)**

```bash
# Fold 1~5 ëª¨ë¸ ì•™ìƒë¸” ì¶”ë¡ 
python scripts/inference.py \
  --mode ensemble \
  --models \
    experiments/20251014/20251014_183206_kobart_ultimate_kfold/fold_1/kfold/final_model \
    experiments/20251014/20251014_183206_kobart_ultimate_kfold/fold_3/kfold/final_model \
    experiments/20251014/20251014_183206_kobart_ultimate_kfold/fold_4/kfold/final_model \
    experiments/20251014/20251014_183206_kobart_ultimate_kfold/fold_5/kfold/final_model \
  --ensemble_strategy weighted_vote \
  --weights 1.0 1.0 1.5 1.0 \
  --test_file data/raw/test.csv \
  --output_file submissions/kfold_ensemble.csv

# ì˜ˆìƒ ì„±ëŠ¥: ROUGE-L 0.4570 ~ 0.4600 (46~46.5%)
# ì˜ˆìƒ ì‹œê°„: 10~15ë¶„
```

**ì „ëµ 2: Fold 2 ì¬ì‹¤í–‰ (ì„ íƒ)**

```bash
# Fold 2ë§Œ ì¬í•™ìŠµ
python scripts/train.py \
  --mode kfold \
  --models kobart \
  --epochs 10 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --learning_rate 7.568e-5 \
  --warmup_ratio 0.1196 \
  --weight_decay 0.0922 \
  --scheduler_type polynomial \
  --k_folds 5 \
  --fold_index 2 \
  --early_stopping_patience 5 \
  --experiment_name kobart_ultimate_kfold_fold2_retry \
  --seed 42

# Early Stopping patience ì¦ê°€ë¡œ ì¬í•™ìŠµ
```

#### ğŸ”¬ ì¶”ê°€ ìµœì í™” (ì„ íƒì )

**ì „ëµ 3: Optuna + K-Fold ì¡°í•©**

- Optunaë¡œ ë°œê²¬í•œ ì—¬ëŸ¬ ìƒìœ„ Trialë“¤ì„ K-Foldë¡œ ê°ê° ê²€ì¦
- Trial 4, 10, 11, 12ì˜ íŒŒë¼ë¯¸í„°ë¡œ K-Fold ì¬ì‹¤í–‰
- ê°€ì¥ ì•ˆì •ì ì¸ íŒŒë¼ë¯¸í„° ì„ íƒ

**ì „ëµ 4: ë°ì´í„° ì¦ê°• + K-Fold**

- í˜„ì¬ K-FoldëŠ” ì¦ê°• í™œì„±í™” ìƒíƒœ
- ì¦ê°• ì—†ëŠ” K-Foldì™€ ë¹„êµ ì‹¤í—˜
- ì¦ê°• íš¨ê³¼ ì •ëŸ‰í™”

### 7.3 ì˜ˆìƒ ìµœì¢… ì„±ëŠ¥

```mermaid
graph LR
    A[í˜„ì¬ K-Fold<br/>í‰ê· : 0.4529] --> B[5-Model ì•™ìƒë¸”<br/>ì˜ˆìƒ: 0.458]
    B --> C[ì¶”ë¡  ê³ ë„í™”<br/>Solar + HF<br/>ì˜ˆìƒ: 0.475]
    C --> D[ìµœì¢… ëª©í‘œ<br/>ROUGE-L<br/>0.48+]

    style A fill:#81c784,stroke:#2e7d32,color:#000
    style B fill:#66bb6a,stroke:#2e7d32,color:#fff
    style C fill:#4caf50,stroke:#1b5e20,color:#fff
    style D fill:#2e7d32,stroke:#1b5e20,color:#fff
```

**ë‹¨ê³„ë³„ ê°œì„  ë¡œë“œë§µ:**

1. **í˜„ì¬ K-Fold**: ROUGE-L 0.4529 (45.29%)
2. **5-Model ì•™ìƒë¸”**: ì˜ˆìƒ 0.4580 (+1.1%)
3. **ì¶”ë¡  ìµœì í™”**: ì˜ˆìƒ 0.4750 (+3.8%)
4. **ìµœì¢… ëª©í‘œ**: **0.4800+ (48% ì´ìƒ)**

### 7.4 ì‹¤í—˜ì—ì„œ ë°°ìš´ ì 

1. **K-Foldì˜ ê°€ì¹˜**
   - ë‹¨ì¼ ëª¨ë¸ ëŒ€ë¹„ -1.5% ì„±ëŠ¥
   - í•˜ì§€ë§Œ ì¼ë°˜í™” ëŠ¥ë ¥ ê²€ì¦
   - ì•™ìƒë¸”ë¡œ íšŒë³µ ê°€ëŠ¥

2. **Optuna ìµœì í™”ì˜ íš¨ê³¼**
   - Trial 4 íŒŒë¼ë¯¸í„°ê°€ K-Foldì—ì„œë„ ìš°ìˆ˜
   - ëª¨ë“  Foldì—ì„œ 45% ì´ìƒ
   - í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” í•„ìˆ˜

3. **Early Stopping ì£¼ì˜**
   - Fold 2 ì¡°ê¸° ì¢…ë£Œ ì´ìŠˆ
   - Patience ì„¤ì • ì¤‘ìš”
   - ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§ í•„ìš”

4. **ì‹œê°„ íš¨ìœ¨ì„±**
   - K-Fold: 2.5ì‹œê°„ (5 folds)
   - ë‹¨ì¼ ëª¨ë¸: 10ë¶„
   - ì•™ìƒë¸” íš¨ê³¼ ê³ ë ¤ ì‹œ ê°€ì¹˜ ìˆìŒ

---

## 8. ì°¸ê³  ìë£Œ

### 8.1 ì‹¤í—˜ íŒŒì¼ ìœ„ì¹˜

```
experiments/20251014/20251014_183206_kobart_ultimate_kfold/
â”œâ”€â”€ command.txt                      # ì‹¤í–‰ ëª…ë ¹ì–´
â”œâ”€â”€ train.log                        # ì „ì²´ í•™ìŠµ ë¡œê·¸
â”œâ”€â”€ kfold_results.json               # K-Fold ê²°ê³¼ (ë©”íŠ¸ë¦­ ëˆ„ë½)
â”œâ”€â”€ fold_1/
â”‚   â””â”€â”€ kfold/
â”‚       â”œâ”€â”€ checkpoint-5607/
â”‚       â”œâ”€â”€ checkpoint-6230/
â”‚       â””â”€â”€ final_model/             # Fold 1 ìµœì¢… ëª¨ë¸
â”œâ”€â”€ fold_2/
â”‚   â””â”€â”€ kfold/
â”‚       â”œâ”€â”€ checkpoint-3115/
â”‚       â”œâ”€â”€ checkpoint-4984/
â”‚       â””â”€â”€ final_model/             # Fold 2 ìµœì¢… ëª¨ë¸ (8 epochs)
â”œâ”€â”€ fold_3/
â”‚   â””â”€â”€ kfold/
â”‚       â”œâ”€â”€ checkpoint-4984/
â”‚       â”œâ”€â”€ checkpoint-6230/
â”‚       â””â”€â”€ final_model/             # Fold 3 ìµœì¢… ëª¨ë¸
â”œâ”€â”€ fold_4/
â”‚   â””â”€â”€ kfold/
â”‚       â”œâ”€â”€ checkpoint-4361/
â”‚       â”œâ”€â”€ checkpoint-6230/
â”‚       â””â”€â”€ final_model/             # Fold 4 ìµœì¢… ëª¨ë¸
â””â”€â”€ fold_5/
    â””â”€â”€ kfold/
        â”œâ”€â”€ checkpoint-5607/
        â”œâ”€â”€ checkpoint-6230/
        â””â”€â”€ final_model/             # Fold 5 ìµœì¢… ëª¨ë¸
```

### 8.2 ê´€ë ¨ ë¬¸ì„œ

- `docs/experiments/20251014_154616_kobart_ultimate_optuna_ì‹¤í—˜ë¶„ì„.md`: Optuna ìµœì í™” ì‹¤í—˜ (2ì°¨)
- `docs/experiments/20251014_094051_kobart_ultimate_optuna_ì‹¤í—˜ë¶„ì„.md`: Optuna ìµœì í™” ì‹¤í—˜ (1ì°¨)
- `docs/ëª¨ë“ˆí™”/04_02_KoBART_ë‹¨ì¼ëª¨ë¸_ìµœê°•_ì„±ëŠ¥_ì „ëµ.md`: ì „ëµ ê°€ì´ë“œ

### 8.3 ì„±ëŠ¥ ë¹„êµ ìš”ì•½

| ì‹¤í—˜ | ROUGE-L F1 | í•™ìŠµ ì‹œê°„ | íŠ¹ì§• |
|------|-----------|----------|------|
| Optuna Trial 11 (1ì°¨) | **0.4616** | 9.8ë¶„ | Cosine, 7 epochs |
| Optuna Trial 4 (2ì°¨) | 0.4598 | 11.5ë¶„ | Polynomial, 10 epochs |
| **K-Fold í‰ê· ** | **0.4529** | 136.5ë¶„ | 5-Fold, ì¼ë°˜í™” ê²€ì¦ |
| K-Fold Fold 4 (ìµœê³ ) | **0.4585** | 28.4ë¶„ | ë‹¨ì¼ Fold ìµœê³  ì„±ëŠ¥ |

### 8.4 WandB ì‹¤í—˜ ë§í¬

- í”„ë¡œì íŠ¸: https://wandb.ai/kimsunmin0227-hufs/dialogue-summarization
- ì‹¤í—˜: https://wandb.ai/kimsunmin0227-hufs/dialogue-summarization/runs/vsrvwfcc

---

**ì‘ì„±ì¼**: 2025-10-14
**ì‹¤í—˜ ìƒíƒœ**: âœ… ì™„ë£Œ (Fold 2 ì¡°ê¸° ì¢…ë£Œ, ë‚˜ë¨¸ì§€ ì •ìƒ)
**ê¶Œì¥ ì¡°ì¹˜**: 5-Model ì•™ìƒë¸” ì¶”ë¡  ì‹¤í–‰
