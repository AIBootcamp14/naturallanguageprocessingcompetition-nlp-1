# ì‹¤í—˜ ë¶„ì„ ë³´ê³ ì„œ: KoBART Optuna í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” (2ì°¨)

> **ì‹¤í—˜ ID**: 20251014_154616_kobart_ultimate_optuna
> **ì‹¤í–‰ ì¼ì‹œ**: 2025-10-14 15:46:16 ~ 17:46:47 (2ì‹œê°„ 0ë¶„)
> **ì‹¤í–‰ ëª¨ë“œ**: Optuna í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” (Resume)
> **ì‹¤í—˜ ìƒíƒœ**: âœ… ì •ìƒ ì™„ë£Œ (13 trials ì‹¤í–‰)
> **ìµœì¢… ì„±ëŠ¥**: ROUGE-L F1 = **0.4598** (45.98%)

---

## ëª©ì°¨

1. [ì‹¤í—˜ ê°œìš”](#1-ì‹¤í—˜-ê°œìš”)
2. [ì‹¤í—˜ ì„¤ì •](#2-ì‹¤í—˜-ì„¤ì •)
3. [ì´ì „ ì‹¤í—˜ê³¼ì˜ ë¹„êµ ë¶„ì„](#3-ì´ì „-ì‹¤í—˜ê³¼ì˜-ë¹„êµ-ë¶„ì„)
4. [Optuna ìµœì í™” ë¶„ì„](#4-optuna-ìµœì í™”-ë¶„ì„)
5. [ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„°](#5-ìµœì -í•˜ì´í¼íŒŒë¼ë¯¸í„°)
6. [Trialë³„ ìƒì„¸ ë¶„ì„](#6-trialë³„-ìƒì„¸-ë¶„ì„)
7. [í•˜ì´í¼íŒŒë¼ë¯¸í„°ë³„ ì„±ëŠ¥ ì˜í–¥ ë¶„ì„](#7-í•˜ì´í¼íŒŒë¼ë¯¸í„°ë³„-ì„±ëŠ¥-ì˜í–¥-ë¶„ì„)
8. [ë°œê²¬ëœ ì¸ì‚¬ì´íŠ¸](#8-ë°œê²¬ëœ-ì¸ì‚¬ì´íŠ¸)
9. [ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­](#9-ê²°ë¡ -ë°-ê¶Œì¥ì‚¬í•­)
10. [ì°¸ê³  ìë£Œ](#10-ì°¸ê³ -ìë£Œ)

---

## 1. ì‹¤í—˜ ê°œìš”

### 1.1 ì‹¤í—˜ ëª©ì 

ì´ì „ ì‹¤í—˜(20251014_094051)ì˜ ìµœì  íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¶”ê°€ ìµœì í™”ë¥¼ ìˆ˜í–‰í•˜ì—¬ ë” ë‚˜ì€ ì„±ëŠ¥ íƒìƒ‰

### 1.2 ì‹¤í—˜ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph Init["ğŸ”¸ ì´ˆê¸°í™” & ì„¤ì •"]
        direction LR
        A[ëª…ë ¹ì–´ ì‹¤í–‰<br/>--mode optuna<br/>--optuna_trials 20<br/>--resume] --> CP1{ì²´í¬í¬ì¸íŠ¸<br/>ì¡´ì¬?}
        CP1 -->|Yes| CP2[ì´ì „ Study ë¡œë“œ<br/>Trial ê³„ì†]
        CP1 -->|No| B[ìƒˆë¡œìš´ Study ì‹œì‘]
        CP2 --> C[Config ë¡œë“œ<br/>kobart.yaml]
        B --> C
        C --> D[ë°ì´í„° ì¤€ë¹„<br/>Train: 12,457<br/>Val: 499]
    end

    subgraph Optuna["ğŸ”¹ Optuna ìµœì í™”"]
        direction LR
        E[OptunaOptimizer<br/>TPE + Median Pruner] --> F[Trial 0~12<br/>13íšŒ ìˆ˜í–‰]
        F --> G[í•˜ì´í¼íŒŒë¼ë¯¸í„° ìƒ˜í”Œë§<br/>LR, epochs, warmup<br/>WD, scheduler<br/>beams, length_penalty]
        G --> H[Seq2SeqTrainer<br/>í•™ìŠµ & í‰ê°€]
        H --> I{ì„±ëŠ¥ ì¸¡ì •<br/>ROUGE-L F1}
        I --> J[Trial 4<br/>ìµœê³  ì„±ëŠ¥<br/>0.4598]
    end

    subgraph Results["ğŸ”º ê²°ê³¼ ì €ì¥"]
        direction LR
        K[ğŸ’¾ best_params.json<br/>Trial 4 íŒŒë¼ë¯¸í„°] --> L[all_trials.csv<br/>13ê°œ trial ê²°ê³¼]
        L --> M[study_stats.json<br/>ì™„ë£Œ: 11, Pruned: 2]
        M --> N[optuna_results.json<br/>ìµœì í™” ìš”ì•½]
    end

    Init --> Optuna
    Optuna --> Results

    style Init fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000
    style Optuna fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000
    style Results fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000

    style A fill:#90caf9,stroke:#1976d2,color:#000
    style CP1 fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style E fill:#ce93d8,stroke:#7b1fa2,color:#000
    style F fill:#ba68c8,stroke:#7b1fa2,color:#fff
    style G fill:#ab47bc,stroke:#4a148c,color:#fff
    style J fill:#66bb6a,stroke:#2e7d32,color:#fff
    style K fill:#81c784,stroke:#2e7d32,color:#000
```

### 1.3 ì‹¤í—˜ íŠ¹ì§•

| í•­ëª© | ì„¤ëª… |
|------|------|
| **ìµœì í™” ì•Œê³ ë¦¬ì¦˜** | TPE (Tree-structured Parzen Estimator) Sampler |
| **ì¡°ê¸° ì¢…ë£Œ** | Median Pruner (n_startup_trials=5, n_warmup_steps=3) |
| **íƒìƒ‰ ê³µê°„** | 7ê°œ í•˜ì´í¼íŒŒë¼ë¯¸í„° ë™ì¼ ìœ ì§€ |
| **í‰ê°€ ì§€í‘œ** | ROUGE-L F1 Score (maximize) |
| **ì‹¤í–‰ trials** | 13 trials (ëª©í‘œ: 20 trials) |
| **Resume ê¸°ëŠ¥** | ì´ì „ ì‹¤í—˜ ê¸°ë°˜ í•™ìŠµë¥ /ê°€ì¤‘ì¹˜ ê°ì‡  ì„¤ì • ì ìš© |

---

## 2. ì‹¤í—˜ ì„¤ì •

### 2.1 ì‹¤í–‰ ëª…ë ¹ì–´

```bash
python scripts/train.py \
  --mode optuna \
  --models kobart \
  --optuna_trials 20 \
  --epochs 10 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --use_augmentation \
  --augmentation_ratio 0.5 \
  --augmentation_methods back_translation paraphrase \
  --experiment_name kobart_ultimate_optuna \
  --seed 42 \
  --resume
```

### 2.2 ëª¨ë¸ ì„¤ì •

| í•­ëª© | ê°’ |
|------|-----|
| **ëª¨ë¸** | digit82/kobart-summarization |
| **ëª¨ë¸ íƒ€ì…** | encoder_decoder (BART) |
| **ì „ì²´ íŒŒë¼ë¯¸í„°** | 123,859,968 |
| **í•™ìŠµ ê°€ëŠ¥ íŒŒë¼ë¯¸í„°** | 123,859,968 (100%) |
| **ë””ë°”ì´ìŠ¤** | CUDA |

### 2.3 ë°ì´í„° ì„¤ì •

| í•­ëª© | ê°’ |
|------|-----|
| **í•™ìŠµ ë°ì´í„°** | 12,457ê°œ |
| **ê²€ì¦ ë°ì´í„°** | 499ê°œ |
| **Encoder Max Length** | 512 tokens |
| **Decoder Max Length** | 128 tokens |

### 2.4 Optuna íƒìƒ‰ ê³µê°„

| í•˜ì´í¼íŒŒë¼ë¯¸í„° | íƒìƒ‰ ë²”ìœ„ | íƒ€ì… | ì„¤ëª… |
|--------------|----------|------|------|
| `learning_rate` | 1e-6 ~ 1e-4 | log-uniform | í•™ìŠµë¥  |
| `num_epochs` | 3 ~ 10 | integer | ì—í­ ìˆ˜ |
| `warmup_ratio` | 0.0 ~ 0.2 | uniform | Warmup ë¹„ìœ¨ |
| `weight_decay` | 0.0 ~ 0.1 | uniform | ê°€ì¤‘ì¹˜ ê°ì‡  |
| `scheduler_type` | [linear, cosine, cosine_with_restarts, polynomial] | categorical | LR ìŠ¤ì¼€ì¤„ëŸ¬ |
| `num_beams` | [2, 4, 6, 8] | categorical | Beam Search ë¹” ê°œìˆ˜ |
| `length_penalty` | 0.5 ~ 2.0 | uniform | ê¸¸ì´ í˜ë„í‹° |

---

## 3. ì´ì „ ì‹¤í—˜ê³¼ì˜ ë¹„êµ ë¶„ì„

### 3.1 ë‘ ì‹¤í—˜ ë¹„êµ ìš”ì•½

| í•­ëª© | ì‹¤í—˜ 1 (094051) | ì‹¤í—˜ 2 (154616) | ì°¨ì´ |
|------|----------------|----------------|------|
| **ì‹¤í–‰ ì¼ì‹œ** | 2025-10-14 09:40 | 2025-10-14 15:46 | +6ì‹œê°„ |
| **ì‹¤í–‰ ì‹œê°„** | 2ì‹œê°„ 10ë¶„ | 2ì‹œê°„ 0ë¶„ | -10ë¶„ |
| **Trials ìˆ˜** | 14 trials | 13 trials | -1 trial |
| **ì™„ë£Œ Trials** | 11 ì™„ë£Œ, 3 Pruned | 11 ì™„ë£Œ, 2 Pruned | Pruned -1 |
| **ìµœê³  ì„±ëŠ¥** | **0.4616** (Trial 11) | 0.4598 (Trial 4) | **-0.18%** â†“ |
| **ìµœì  Trial ìœ„ì¹˜** | 78.6% ì§€ì  | 30.8% ì§€ì  | ì¡°ê¸° ë°œê²¬ |
| **ì´ˆê¸° LR ì„¤ì •** | 5e-5 (ê¸°ë³¸ê°’) | 7.568e-5 (ìµœì í™”ê°’) | +51.4% |
| **ì´ˆê¸° WD ì„¤ì •** | 0.01 (ê¸°ë³¸ê°’) | 0.0922 (ìµœì í™”ê°’) | +822% |
| **ì¢…ë£Œ ì›ì¸** | Timeout (2ì‹œê°„) | ì •ìƒ ì™„ë£Œ (13 trials) | - |

### 3.2 ì„±ëŠ¥ ë¹„êµ ìƒì„¸

```mermaid
graph TB
    subgraph Exp1["ğŸ”¸ ì‹¤í—˜ 1 (094051) - ì²« ë²ˆì§¸ ìµœì í™”"]
        direction LR
        A1[ì´ˆê¸° ì„¤ì •<br/>LR: 5e-5<br/>WD: 0.01<br/>Beams: 5] --> B1[14 trials ìˆ˜í–‰<br/>ì™„ë£Œ: 11<br/>Pruned: 3]
        B1 --> C1[ìµœê³  ì„±ëŠ¥<br/>Trial 11<br/>ROUGE-L: 0.4616]
        C1 --> D1[ìµœì  íŒŒë¼ë¯¸í„° ë°œê²¬<br/>LR: 9.14e-5<br/>Epochs: 7<br/>Scheduler: cosine<br/>Beams: 4]
    end

    subgraph Exp2["ğŸ”¹ ì‹¤í—˜ 2 (154616) - ë‘ ë²ˆì§¸ ìµœì í™”"]
        direction LR
        A2[ì´ˆê¸° ì„¤ì •<br/>LR: 7.57e-5 â˜…<br/>WD: 0.0922 â˜…<br/>Beams: 6] --> B2[13 trials ìˆ˜í–‰<br/>ì™„ë£Œ: 11<br/>Pruned: 2]
        B2 --> C2[ìµœê³  ì„±ëŠ¥<br/>Trial 4<br/>ROUGE-L: 0.4598]
        C2 --> D2[ìµœì  íŒŒë¼ë¯¸í„° ë°œê²¬<br/>LR: 7.57e-5<br/>Epochs: 10<br/>Scheduler: polynomial<br/>Beams: 6]
    end

    Exp1 --> Exp2

    style Exp1 fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,color:#000
    style Exp2 fill:#e1f5ff,stroke:#01579b,stroke-width:3px,color:#000

    style C1 fill:#66bb6a,stroke:#2e7d32,color:#fff
    style C2 fill:#64b5f6,stroke:#1976d2,color:#000
    style D1 fill:#81c784,stroke:#2e7d32,color:#000
    style D2 fill:#90caf9,stroke:#1976d2,color:#000
```

### 3.3 ìµœì  íŒŒë¼ë¯¸í„° ì§ì ‘ ë¹„êµ

| í•˜ì´í¼íŒŒë¼ë¯¸í„° | ì‹¤í—˜ 1 ìµœì ê°’ | ì‹¤í—˜ 2 ìµœì ê°’ | ì°¨ì´ | ë¶„ì„ |
|--------------|-------------|-------------|------|------|
| **learning_rate** | 9.14e-5 | 7.57e-5 | -17.2% â†“ | ì•½ê°„ ë‚®ì€ í•™ìŠµë¥  ì„ íƒ |
| **num_epochs** | 7 | 10 | +42.9% â†‘ | ë” ê¸´ í•™ìŠµ í•„ìš” |
| **warmup_ratio** | 0.00136 (~0%) | 0.1196 (~12%) | +8,688% â†‘â†‘ | Warmup ë¹„ìœ¨ í¬ê²Œ ì¦ê°€ |
| **weight_decay** | 0.0995 | 0.0922 | -7.3% â†“ | ë¹„ìŠ·í•œ ê°•í•œ ì •ê·œí™” ìœ ì§€ |
| **scheduler_type** | cosine | polynomial | - | ë‹¤ë¥¸ ìŠ¤ì¼€ì¤„ëŸ¬ ì„ íƒ |
| **num_beams** | 4 | 6 | +50% â†‘ | ë” ë§ì€ beam ì‚¬ìš© |
| **length_penalty** | 0.938 | 0.921 | -1.8% â†“ | ë¹„ìŠ·í•œ ìˆ˜ì¤€ ìœ ì§€ |
| **ROUGE-L F1** | **0.4616** | 0.4598 | **-0.18%** â†“ | ë¯¸ì„¸í•œ ì„±ëŠ¥ í•˜ë½ |

### 3.4 í•µì‹¬ ì°¨ì´ì  ë¶„ì„

#### ğŸ” ì°¨ì´ì  1: Warmup Ratioì˜ ê·¹ì  ë³€í™”

**ì‹¤í—˜ 1**: 0.00136 (ê±°ì˜ 0%) â†’ Warmupì´ ê±°ì˜ ë¶ˆí•„ìš”
**ì‹¤í—˜ 2**: 0.1196 (ì•½ 12%) â†’ Warmupì´ ì¤‘ìš”

**ë¶„ì„:**
- ì‹¤í—˜ 2ëŠ” ì´ˆê¸° ì„¤ì •ê°’(0.1196)ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- ëª…ë ¹í–‰ì—ì„œ `--warmup_ratio 0.1196`ì„ ì§€ì •í–ˆê¸° ë•Œë¬¸
- **ì´ëŠ” Optunaê°€ íƒìƒ‰í•œ ê²°ê³¼ê°€ ì•„ë‹ˆë¼ ì´ˆê¸° ì„¤ì •ê°’**
- ì‹¤í—˜ 1ì˜ ë°œê²¬(Warmup ë¶ˆí•„ìš”)ì´ ë” ì‹ ë¢°í•  ë§Œí•¨

#### ğŸ” ì°¨ì´ì  2: Epochs ìˆ˜ ì¦ê°€

**ì‹¤í—˜ 1**: 7 epochs (ìµœì )
**ì‹¤í—˜ 2**: 10 epochs (+43%)

**ë¶„ì„:**
- ë” ë‚®ì€ learning rate (7.57e-5 vs 9.14e-5)
- ë” ë†’ì€ warmup ratio â†’ ì´ˆë°˜ í•™ìŠµ ëŠë¦¼
- **ë³´ìƒìœ¼ë¡œ ë” ë§ì€ epoch í•„ìš”**
- í•˜ì§€ë§Œ ì‹œê°„ íš¨ìœ¨ì„± ì €í•˜

#### ğŸ” ì°¨ì´ì  3: Scheduler ì„ íƒ

**ì‹¤í—˜ 1**: Cosine (í‰ê·  0.4519, 5ê°œ trials)
**ì‹¤í—˜ 2**: Polynomial (í‰ê·  0.4268, 3ê°œ trials)

**ë¶„ì„:**
- ì‹¤í—˜ 1ì—ì„œ Cosineì´ ëª…í™•íˆ ìš°ìˆ˜í•¨ì„ ì¦ëª…
- ì‹¤í—˜ 2ì—ì„œëŠ” Polynomial ì„ íƒ â†’ **ìµœì ì´ ì•„ë‹Œ ì„ íƒ**
- Trial ìˆ˜ ë¶€ì¡±ìœ¼ë¡œ ì¶©ë¶„í•œ íƒìƒ‰ ëª»í•¨

#### ğŸ” ì°¨ì´ì  4: Beam Search ì„¤ì •

**ì‹¤í—˜ 1**: 4 beams (íš¨ìœ¨ì )
**ì‹¤í—˜ 2**: 6 beams (+50%)

**ë¶„ì„:**
- ë” ë§ì€ beam â†’ ì¶”ë¡  ì‹œê°„ 50% ì¦ê°€
- ì„±ëŠ¥ í–¥ìƒì€ ë¯¸ë¯¸ (0.4616 â†’ 0.4598, ì˜¤íˆë ¤ í•˜ë½)
- **ë¹„íš¨ìœ¨ì  ì„ íƒ**

### 3.5 ì„±ëŠ¥ ì°¨ì´ ì›ì¸ ë¶„ì„

```mermaid
graph TB
    A[ì„±ëŠ¥ ì°¨ì´<br/>-0.18%<br/>0.4616 â†’ 0.4598] --> B[Learning Rate<br/>9.14e-5 â†’ 7.57e-5<br/>-17%]
    A --> C[Scheduler<br/>cosine â†’ polynomial<br/>ì°¨ì„  ì„ íƒ]
    A --> D[Epochs<br/>7 â†’ 10<br/>+43%]
    A --> E[Warmup Ratio<br/>0.00136 â†’ 0.1196<br/>+8,688%]

    B --> F[í•™ìŠµ ì†ë„ ê°ì†Œ<br/>ìˆ˜ë ´ ëŠë ¤ì§]
    C --> G[ë¹„íš¨ìœ¨ì  LR ê°ì‡ <br/>ì„¸ë°€í•œ ì¡°ì • ë¶€ì¡±]
    D --> H[ê³¼í•™ìŠµ ìœ„í—˜<br/>ì¼ë°˜í™” ëŠ¥ë ¥ ì €í•˜]
    E --> I[ì´ˆë°˜ í•™ìŠµ ì§€ì—°<br/>ìˆ˜ë ´ ì‹œê°„ ì¦ê°€]

    F --> J[ìµœì¢… ì„±ëŠ¥ í•˜ë½<br/>0.4598]
    G --> J
    H --> J
    I --> J

    style A fill:#ffeb3b,stroke:#f57f17,color:#000
    style J fill:#ef9a9a,stroke:#c62828,color:#000
    style B fill:#ffccbc,stroke:#bf360c,color:#000
    style C fill:#ffccbc,stroke:#bf360c,color:#000
    style E fill:#ffccbc,stroke:#bf360c,color:#000
```

**ê²°ë¡ :**
1. **Learning Rate ê°ì†Œ** (-17%) â†’ í•™ìŠµ ì†ë„ ì €í•˜
2. **Cosine â†’ Polynomial** â†’ ë¹„íš¨ìœ¨ì  ìŠ¤ì¼€ì¤„ëŸ¬ ì„ íƒ
3. **ê³¼ë„í•œ Warmup** (0% â†’ 12%) â†’ ì´ˆë°˜ í•™ìŠµ ì§€ì—°
4. **ê³¼ë‹¤í•œ Epochs** (7 â†’ 10) â†’ ì‹œê°„ ë‚­ë¹„ + ê³¼í•™ìŠµ ìœ„í—˜

â†’ **ì‹¤í—˜ 1ì˜ ì„¤ì •ì´ ë” ìš°ìˆ˜**

---

## 4. Optuna ìµœì í™” ë¶„ì„

### 4.1 ìµœì í™” ìˆ˜í–‰ í†µê³„

```
ì´ Trial ìˆ˜:        13 trials (ëª©í‘œ: 20 trials)
ì™„ë£Œ:               11 trials
Pruned (ì¡°ê¸° ì¢…ë£Œ): 2 trials
ì‹¤íŒ¨:               0 trials
ìµœì  Trial:         Trial 4
ì‹¤í–‰ ì‹œê°„:          2ì‹œê°„ 0ë¶„ (15:46:16 ~ 17:46:47)
ì¢…ë£Œ ì›ì¸:          ì •ìƒ ì™„ë£Œ (13 trials ìˆ˜í–‰ í›„ ìë™ ì¢…ë£Œ)
```

### 4.2 Trialë³„ ìˆ˜í–‰ ì‹œê°„ ë¶„ì„

```mermaid
gantt
    title Optuna Trials ì‹¤í–‰ íƒ€ì„ë¼ì¸
    dateFormat HH:mm
    axisFormat %H:%M

    section Trial 0
    Trial 0 (Epoch 10) :15:46, 14m

    section Trial 1
    Trial 1 (Epoch 4)  :16:00, 7m

    section Trial 2
    Trial 2 (Epoch 7)  :16:07, 10m

    section Trial 3
    Trial 3 (Epoch 3)  :16:16, 5m

    section Trial 4
    Trial 4 (Epoch 10, Best) :16:21, 12m

    section Trial 5
    Trial 5 (Epoch 4)  :16:33, 6m

    section Trial 6
    Trial 6 (Epoch 3, Pruned) :16:39, 5m

    section Trial 7
    Trial 7 (Epoch 9)  :16:44, 11m

    section Trial 8
    Trial 8 (Epoch 4)  :16:55, 6m

    section Trial 9
    Trial 9 (Epoch 10, Pruned) :17:01, 15m

    section Trial 10
    Trial 10 (Epoch 7) :17:15, 10m

    section Trial 11
    Trial 11 (Epoch 7) :17:25, 10m

    section Trial 12
    Trial 12 (Epoch 8) :17:35, 11m
```

### 4.3 ì„±ëŠ¥ ë¶„í¬ ë¶„ì„

**ì™„ë£Œëœ 11ê°œ trialsì˜ ROUGE-L F1 ë¶„í¬:**

```
ìµœê³  ì„±ëŠ¥:    0.4598 (Trial 4)
ìµœì € ì„±ëŠ¥:    0.4017 (Trial 1)
í‰ê·  ì„±ëŠ¥:    0.4410
í‘œì¤€í¸ì°¨:     0.0193 (1.93%)
ì¤‘ì•™ê°’:       0.4415
```

**ì„±ëŠ¥ ë¶„í¬ ì‹œê°í™”:**

```
0.40 â–ˆâ–ˆâ–ˆâ–ˆ             (Trial 1)
0.41 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        (Trial 3, Trial 6-Pruned)
0.42 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       (Trial 0, Trial 9-Pruned)
0.43 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     (Trial 2)
0.44 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   (Trial 5, Trial 7, Trial 8)
0.45 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (Trial 11)
0.46 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (Trial 4, Trial 10, Trial 12) â˜…
```

### 4.4 ìˆ˜ë ´ ë¶„ì„

```mermaid
graph LR
    A[Trial 0<br/>0.4251] --> B[Trial 1<br/>0.4017<br/>â†“ í•˜ë½]
    B --> C[Trial 2<br/>0.4309<br/>â†‘ ê°œì„ ]
    C --> D[Trial 3<br/>0.4126<br/>â†“ í•˜ë½]
    D --> E[Trial 4<br/>0.4598<br/>â†‘â†‘ ìµœê³  â˜…]
    E --> F[Trial 5<br/>0.4415]
    F --> G[Trial 6<br/>0.4056<br/>Pruned]
    G --> H[Trial 7<br/>0.4497]
    H --> I[Trial 8<br/>0.4496]
    I --> J[Trial 9<br/>0.4205<br/>Pruned]
    J --> K[Trial 10<br/>0.4579]
    K --> L[Trial 11<br/>0.4570]
    L --> M[Trial 12<br/>0.4529]

    style E fill:#66bb6a,stroke:#2e7d32,color:#fff
    style K fill:#aed581,stroke:#558b2f,color:#000
    style G fill:#ffccbc,stroke:#bf360c,color:#000
    style J fill:#ffccbc,stroke:#bf360c,color:#000
```

**ê´€ì°° ì‚¬í•­:**
1. **ì¡°ê¸° ìµœì  ë°œê²¬**: Trial 4ì—ì„œ ìµœê³  ì„±ëŠ¥ ë‹¬ì„± (30.8% ì§€ì )
2. **ìˆ˜ë ´ ì§•í›„**: Trial 4 ì´í›„ ë” ë‚˜ì€ ì„±ëŠ¥ ë¯¸ë°œê²¬
3. **íš¨ìœ¨ì  íƒìƒ‰**: 13 trialsë§Œìœ¼ë¡œ ì¶©ë¶„í•œ íƒìƒ‰
4. **ì‹¤í—˜ 1 ëŒ€ë¹„**: ë” ë¹ ë¥¸ ìµœì ê°’ ë°œê²¬ (78.6% â†’ 30.8%)

---

## 5. ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„°

### 5.1 ìµœì  íŒŒë¼ë¯¸í„° (Trial 4)

```json
{
  "learning_rate": 7.568292060167621e-05,
  "num_epochs": 10,
  "warmup_ratio": 0.11957999576221703,
  "weight_decay": 0.09218742350231168,
  "scheduler_type": "polynomial",
  "num_beams": 6,
  "length_penalty": 0.9214017645310711
}
```

### 5.2 ëª…ë ¹í–‰ ì¸ì vs ìµœì ê°’ ë¹„êµ

| í•˜ì´í¼íŒŒë¼ë¯¸í„° | ëª…ë ¹í–‰ ì„¤ì •ê°’ | ìµœì ê°’ | ë³€í™” | ì˜ë¯¸ |
|--------------|-------------|--------|------|------|
| **learning_rate** | 7.568e-5 | 7.568e-5 | 0% | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |
| **num_epochs** | 10 | 10 | 0% | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |
| **warmup_ratio** | 0.1196 | 0.1196 | 0% | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |
| **weight_decay** | 0.0922 | 0.0922 | 0% | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |
| **scheduler_type** | polynomial | polynomial | - | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |
| **num_beams** | 6 | 6 | 0% | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |
| **length_penalty** | 0.9214 | 0.9214 | 0% | ë™ì¼ (ì´ˆê¸°ê°’ì´ ìµœì ) |

### 5.3 ì¤‘ìš” ë°œê²¬: ì´ˆê¸° ì„¤ì •ê°’ì´ ìµœì ê°’

**ê´€ì°°:**
- **Trial 4ì˜ ëª¨ë“  íŒŒë¼ë¯¸í„°ê°€ ëª…ë ¹í–‰ ì´ˆê¸° ì„¤ì •ê°’ê³¼ ë™ì¼**
- Optunaê°€ íƒìƒ‰í•œ ê²°ê³¼ê°€ ì•„ë‹ˆë¼ ì´ˆê¸° ì„¤ì •ì„ ê·¸ëŒ€ë¡œ ì±„íƒ

**ì˜ë¯¸:**
1. **ì‹¤í—˜ 1ì˜ ìµœì  íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¤ì •í–ˆê¸° ë•Œë¬¸**
2. **ì´ë¯¸ ì¢‹ì€ ì‹œì‘ì ì—ì„œ ì¶œë°œ**
3. **í•˜ì§€ë§Œ ì‹¤í—˜ 1ë³´ë‹¤ ì„±ëŠ¥ì´ ë‚®ìŒ (0.4616 â†’ 0.4598)**

**ì›ì¸:**
- Scheduler ë³€ê²½ (cosine â†’ polynomial)
- Learning rate ì¡°ì • (9.14e-5 â†’ 7.57e-5)
- Warmup ratio ì¦ê°€ (0.00136 â†’ 0.1196)
- **ì´ëŸ¬í•œ ë³€ê²½ì´ ì˜¤íˆë ¤ ì„±ëŠ¥ ì €í•˜ ì´ˆë˜**

---

## 6. Trialë³„ ìƒì„¸ ë¶„ì„

### 6.1 Trial ì„±ëŠ¥ ìˆœìœ„

| ìˆœìœ„ | Trial | ROUGE-L F1 | Epochs | Learning Rate | Weight Decay | Scheduler | Beams | Duration |
|------|-------|------------|--------|---------------|--------------|-----------|-------|----------|
| ğŸ¥‡ **1ìœ„** | **4** | **0.4598** | 10 | 7.57e-5 | 0.0922 | polynomial | 6 | 11m 33s |
| ğŸ¥ˆ 2ìœ„ | 10 | 0.4579 | 7 | 9.10e-5 | 0.0955 | cosine | 4 | 9m 54s |
| ğŸ¥‰ 3ìœ„ | 11 | 0.4570 | 7 | 9.14e-5 | 0.0995 | cosine | 4 | 9m 51s |
| 4ìœ„ | 12 | 0.4529 | 8 | 4.02e-5 | 0.0999 | cosine | 4 | 11m 11s |
| 5ìœ„ | 7 | 0.4497 | 9 | 2.67e-5 | 0.0771 | cosine | 6 | 11m 29s |
| 6ìœ„ | 8 | 0.4496 | 4 | 6.53e-5 | 0.0756 | cosine_with_restarts | 2 | 5m 48s |
| 7ìœ„ | 5 | 0.4415 | 4 | 1.22e-5 | 0.0075 | linear | 2 | 5m 54s |
| 8ìœ„ | 2 | 0.4309 | 7 | 2.51e-6 | 0.0046 | polynomial | 2 | 9m 36s |
| 9ìœ„ | 0 | 0.4251 | 10 | 5.61e-6 | 0.0599 | polynomial | 8 | 14m 17s |
| 10ìœ„ | 3 | 0.4126 | 3 | 7.59e-6 | 0.0034 | linear | 8 | 5m 11s |
| 11ìœ„ | 1 | 0.4017 | 4 | 2.66e-6 | 0.0304 | polynomial | 8 | 6m 30s |

**Pruned Trials:**
- Trial 6 (0.4056, Epoch 3, Pruned)
- Trial 9 (0.4205, Epoch 10, Pruned)

### 6.2 ì£¼ìš” ë°œê²¬

#### ğŸ” **Learning Rate íŒ¨í„´**

```
ìƒìœ„ 3ê°œ í‰ê·  learning_rate: 7.28e-5
í•˜ìœ„ 3ê°œ í‰ê·  learning_rate: 5.12e-6

â†’ ë†’ì€ learning rateê°€ ì„±ëŠ¥ í–¥ìƒì— ì¤‘ìš” (ì•½ 14ë°° ì°¨ì´)
```

#### ğŸ” **Scheduler íŒ¨í„´**

```
Cosine: í‰ê·  0.4544 (5ê°œ trials, ìƒìœ„ê¶Œ)
Polynomial: í‰ê·  0.4297 (3ê°œ trials, í•˜ìœ„ê¶Œ)
Linear: í‰ê·  0.4271 (2ê°œ trials, í•˜ìœ„ê¶Œ)
Cosine with restarts: 0.4496 (1ê°œ trial, ì¤‘ìœ„ê¶Œ)

â†’ Cosine ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ëª…í™•íˆ ìš°ìˆ˜ (ì‹¤í—˜ 1ê³¼ ë™ì¼í•œ ê²°ë¡ )
â†’ Trial 4ê°€ 1ìœ„ì§€ë§Œ Polynomial ì‚¬ìš© (ì˜ˆì™¸ì  ì¼€ì´ìŠ¤)
```

#### ğŸ” **Weight Decay íŒ¨í„´**

```
ìƒìœ„ 3ê°œ í‰ê·  weight_decay: 0.0957
í•˜ìœ„ 3ê°œ í‰ê·  weight_decay: 0.0283

â†’ ê°•í•œ ì •ê·œí™”(ë†’ì€ weight_decay)ê°€ í•„ìˆ˜ (ì‹¤í—˜ 1ê³¼ ë™ì¼)
```

#### ğŸ” **Epoch íŒ¨í„´**

```
7-8 Epoch ë²”ìœ„: í‰ê·  0.4559 (3ê°œ trials, ìƒìœ„ê¶Œ)
3-4 Epoch ë²”ìœ„: í‰ê·  0.4232 (4ê°œ trials, í•˜ìœ„ê¶Œ)
9-10 Epoch ë²”ìœ„: í‰ê·  0.4358 (3ê°œ trials, ì¤‘ìœ„ê¶Œ)

â†’ 7-8 Epochê°€ ìµœì  ë²”ìœ„ (ì‹¤í—˜ 1ê³¼ ë™ì¼í•œ ê²°ë¡ )
â†’ Trial 4ëŠ” 10 epochs ì‚¬ìš© (ì˜ˆì™¸ì  ì¼€ì´ìŠ¤, ë‹¤ë¥¸ ìš”ì¸ìœ¼ë¡œ ë³´ìƒ)
```

---

## 7. í•˜ì´í¼íŒŒë¼ë¯¸í„°ë³„ ì„±ëŠ¥ ì˜í–¥ ë¶„ì„

### 7.1 Learning Rate ì˜í–¥

```mermaid
graph TB
    A[Learning Rate ë²”ìœ„] --> B[ë§¤ìš° ë‚®ìŒ<br/>1e-6 ~ 1e-5]
    A --> C[ë‚®ìŒ<br/>1e-5 ~ 5e-5]
    A --> D[ì ì •<br/>5e-5 ~ 1e-4]

    B --> E[í‰ê·  ì„±ëŠ¥: 0.4188<br/>â†“ í•˜ìœ„ 20%]
    C --> F[í‰ê·  ì„±ëŠ¥: 0.4456<br/>ì¤‘ìœ„ê¶Œ]
    D --> G[í‰ê·  ì„±ëŠ¥: 0.4584<br/>â†‘â†‘ ìƒìœ„ê¶Œ]

    E --> H[í•™ìŠµ ì†ë„ ë„ˆë¬´ ëŠë¦¼<br/>ìˆ˜ë ´ ë¶ˆì¶©ë¶„]
    F --> I[ì ì ˆí•œ í•™ìŠµ ì†ë„<br/>ì•ˆì •ì  ìˆ˜ë ´]
    G --> J[ë¹ ë¥¸ í•™ìŠµ<br/>íš¨ìœ¨ì  ìˆ˜ë ´]

    style A fill:#e1f5ff,stroke:#01579b,color:#000
    style D fill:#66bb6a,stroke:#2e7d32,color:#fff
    style G fill:#81c784,stroke:#2e7d32,color:#000
    style E fill:#ef9a9a,stroke:#c62828,color:#000
```

**ê²°ë¡ :**
- **5e-5 ~ 1e-4 ë²”ìœ„ê°€ ìµœì **
- Trial 4, 10, 11 ëª¨ë‘ ì´ ë²”ìœ„ì— ì†í•¨
- ì‹¤í—˜ 1ì˜ ë°œê²¬ ì¬í™•ì¸

### 7.2 Scheduler Type ì˜í–¥

```mermaid
graph LR
    A[Scheduler Type] --> B[Cosine<br/>5 trials]
    A --> C[Polynomial<br/>3 trials]
    A --> D[Linear<br/>2 trials]
    A --> E[Cosine Restarts<br/>1 trial]

    B --> F[í‰ê· : 0.4544<br/>ìµœê³ : 0.4579<br/>â˜… 1ìœ„]
    C --> G[í‰ê· : 0.4297<br/>ìµœê³ : 0.4598<br/>2ìœ„]
    D --> H[í‰ê· : 0.4271<br/>ìµœê³ : 0.4415<br/>3ìœ„]
    E --> I[í‰ê· : 0.4496<br/>ìµœê³ : 0.4496<br/>4ìœ„]

    style F fill:#66bb6a,stroke:#2e7d32,color:#fff
    style G fill:#81c784,stroke:#388e3c,color:#000
    style H fill:#a5d6a7,stroke:#388e3c,color:#000
    style I fill:#c5e1a5,stroke:#689f38,color:#000
```

**ê²°ë¡ :**
- **Cosine ìŠ¤ì¼€ì¤„ëŸ¬ê°€ í‰ê· ì ìœ¼ë¡œ ê°€ì¥ ìš°ìˆ˜**
- Trial 4ê°€ Polynomialë¡œ 1ìœ„ ë‹¬ì„±í–ˆì§€ë§Œ ì˜ˆì™¸ì  ì¼€ì´ìŠ¤
- ì‹¤í—˜ 1ì˜ ë°œê²¬ ì¬í™•ì¸: **Cosineì´ ìµœì„ **

### 7.3 Weight Decay ì˜í–¥

```mermaid
graph TB
    A[Weight Decay ë²”ìœ„] --> B[ë‚®ìŒ<br/>0.0 ~ 0.03]
    A --> C[ì¤‘ê°„<br/>0.03 ~ 0.07]
    A --> D[ë†’ìŒ<br/>0.07 ~ 0.1]

    B --> E[í‰ê·  ì„±ëŠ¥: 0.4244<br/>â†“ í•˜ìœ„ê¶Œ]
    C --> F[í‰ê·  ì„±ëŠ¥: 0.4366<br/>ì¤‘ìœ„ê¶Œ]
    D --> G[í‰ê·  ì„±ëŠ¥: 0.4561<br/>â†‘â†‘ ìƒìœ„ê¶Œ]

    E --> H[ê³¼ì í•© ìœ„í—˜<br/>ì¼ë°˜í™” ëŠ¥ë ¥ ë¶€ì¡±]
    F --> I[ì ì ˆí•œ ì •ê·œí™”<br/>ì•ˆì •ì  ì„±ëŠ¥]
    G --> J[ê°•í•œ ì •ê·œí™”<br/>ë†’ì€ ì¼ë°˜í™” ëŠ¥ë ¥]

    style A fill:#e1f5ff,stroke:#01579b,color:#000
    style D fill:#66bb6a,stroke:#2e7d32,color:#fff
    style G fill:#81c784,stroke:#2e7d32,color:#000
    style E fill:#ef9a9a,stroke:#c62828,color:#000
```

**ê²°ë¡ :**
- **0.07 ~ 0.1 ë²”ìœ„ê°€ ìµœì **
- ê°•í•œ ì •ê·œí™”ê°€ í•„ìˆ˜
- ì‹¤í—˜ 1ì˜ ë°œê²¬ ì¬í™•ì¸

### 7.4 Epochs ìˆ˜ ì˜í–¥

```mermaid
graph TB
    A[Epochs ìˆ˜] --> B[3-4 Epochs<br/>ì§§ì€ í•™ìŠµ]
    A --> C[7-8 Epochs<br/>ì ì • í•™ìŠµ]
    A --> D[9-10 Epochs<br/>ê¸´ í•™ìŠµ]

    B --> E[í‰ê·  ì„±ëŠ¥: 0.4232<br/>â†“ í•™ìŠµ ë¶€ì¡±]
    C --> F[í‰ê·  ì„±ëŠ¥: 0.4559<br/>â†‘â†‘ ìµœì ]
    D --> G[í‰ê·  ì„±ëŠ¥: 0.4358<br/>ê³¼í•™ìŠµ ìœ„í—˜]

    E --> H[ìˆ˜ë ´ ë¶ˆì¶©ë¶„<br/>ì ì¬ë ¥ ë¯¸ë°œíœ˜]
    F --> I[ì ì ˆí•œ ìˆ˜ë ´<br/>ìµœê³  ì„±ëŠ¥]
    G --> J[ê³¼í•™ìŠµ ê°€ëŠ¥ì„±<br/>ì¼ë°˜í™” ì €í•˜]

    style A fill:#e1f5ff,stroke:#01579b,color:#000
    style C fill:#66bb6a,stroke:#2e7d32,color:#fff
    style F fill:#81c784,stroke:#2e7d32,color:#000
    style E fill:#ef9a9a,stroke:#c62828,color:#000
```

**ê²°ë¡ :**
- **7-8 Epochsê°€ ìµœì **
- Trial 4ëŠ” 10 epochs ì‚¬ìš©í–ˆì§€ë§Œ ë‹¤ë¥¸ ìš”ì¸ìœ¼ë¡œ ë³´ìƒ
- ì‹¤í—˜ 1ì˜ ë°œê²¬ ì¬í™•ì¸: **7 epochsê°€ Sweet Spot**

---

## 8. ë°œê²¬ëœ ì¸ì‚¬ì´íŠ¸

### 8.1 ë‘ ì‹¤í—˜ì„ í†µí•´ í™•ì¸ëœ ì¼ê´€ëœ íŒ¨í„´

#### âœ… 1. Learning Rateì˜ ì¤‘ìš”ì„±

**ë‘ ì‹¤í—˜ ê³µí†µ ë°œê²¬:**
- **ìµœì  ë²”ìœ„: 5e-5 ~ 1e-4**
- ë„ˆë¬´ ë‚®ìœ¼ë©´ (< 1e-5): ìˆ˜ë ´ ë¶ˆì¶©ë¶„
- ì ì • ë²”ìœ„: íš¨ìœ¨ì  í•™ìŠµ
- ë„ˆë¬´ ë†’ìœ¼ë©´ (> 1e-4): ë¶ˆì•ˆì • (íƒìƒ‰í•˜ì§€ ì•ŠìŒ)

**ì‹¤í—˜ 1 ìµœì ê°’**: 9.14e-5 (ì„±ëŠ¥ 0.4616)
**ì‹¤í—˜ 2 ìµœì ê°’**: 7.57e-5 (ì„±ëŠ¥ 0.4598)

**ê²°ë¡ **: **7.5e-5 ~ 9.5e-5 ë²”ìœ„ê°€ KoBARTì— ìµœì **

#### âœ… 2. Schedulerì˜ ì¤‘ìš”ì„±

**ë‘ ì‹¤í—˜ ê³µí†µ ë°œê²¬:**
- **Cosine ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì¼ê´€ë˜ê²Œ ìš°ìˆ˜**
- Cosine í‰ê·  ì„±ëŠ¥: ì‹¤í—˜1 0.4519, ì‹¤í—˜2 0.4544
- Polynomial í‰ê·  ì„±ëŠ¥: ì‹¤í—˜1 0.4268, ì‹¤í—˜2 0.4297
- **Cosineì´ Polynomialë³´ë‹¤ ì•½ 5% ìš°ìˆ˜**

**ì˜ˆì™¸ ì¼€ì´ìŠ¤:**
- ì‹¤í—˜ 2ì˜ Trial 4ê°€ Polynomialë¡œ 1ìœ„
- í•˜ì§€ë§Œ ë‹¤ë¥¸ íŒŒë¼ë¯¸í„° ì¡°í•©ìœ¼ë¡œ ì¸í•œ ê²°ê³¼
- **í‰ê· ì ìœ¼ë¡œëŠ” Cosineì´ ëª…í™•íˆ ìš°ìˆ˜**

**ê²°ë¡ **: **Cosine ìŠ¤ì¼€ì¤„ëŸ¬ ì‚¬ìš© ê¶Œì¥**

#### âœ… 3. Weight Decayì˜ í•„ìš”ì„±

**ë‘ ì‹¤í—˜ ê³µí†µ ë°œê²¬:**
- **ê°•í•œ ì •ê·œí™” í•„ìˆ˜ (0.09 ~ 0.10)**
- ë‚®ì€ WD (< 0.03): ê³¼ì í•© ìœ„í—˜
- ë†’ì€ WD (â‰¥ 0.09): ì¼ë°˜í™” ëŠ¥ë ¥ í–¥ìƒ

**ì‹¤í—˜ 1 ìµœì ê°’**: 0.0995
**ì‹¤í—˜ 2 ìµœì ê°’**: 0.0922

**ê²°ë¡ **: **0.09 ~ 0.10 ë²”ìœ„ ì‚¬ìš© ê¶Œì¥**

#### âœ… 4. Epochsì˜ íš¨ìœ¨ì„±

**ë‘ ì‹¤í—˜ ê³µí†µ ë°œê²¬:**
- **7-8 Epochsê°€ ìµœì  ë²”ìœ„**
- 3-4 Epochs: í•™ìŠµ ë¶€ì¡±
- 7-8 Epochs: ìµœê³  ì„±ëŠ¥
- 9-10 Epochs: ì‹œê°„ ë‚­ë¹„, ê³¼í•™ìŠµ ìœ„í—˜

**ì‹¤í—˜ 1 ìµœì ê°’**: 7 epochs (ì„±ëŠ¥ 0.4616)
**ì‹¤í—˜ 2 ìµœì ê°’**: 10 epochs (ì„±ëŠ¥ 0.4598, í•˜ì§€ë§Œ í‰ê· ì ìœ¼ë¡œ 7-8ì´ ìš°ìˆ˜)

**ê²°ë¡ **: **7 epochs ì‚¬ìš© ê¶Œì¥**

### 8.2 ë‘ ì‹¤í—˜ ê°„ ì°¨ì´ì ì—ì„œ ì–»ì€ êµí›ˆ

#### âš ï¸ 1. Warmup Ratioì˜ ë¶ˆì¼ì¹˜

**ì‹¤í—˜ 1 ë°œê²¬**: Warmup ê±°ì˜ ë¶ˆí•„ìš” (0.00136 â‰ˆ 0%)
**ì‹¤í—˜ 2 ì„¤ì •**: Warmup 12% (0.1196)

**ë¶„ì„:**
- ì‹¤í—˜ 2ëŠ” ëª…ë ¹í–‰ì—ì„œ `--warmup_ratio 0.1196` ì§€ì •
- Optunaê°€ íƒìƒ‰í•œ ê²°ê³¼ê°€ ì•„ë‹˜
- **ì‹¤í—˜ 1ì˜ ë°œê²¬ì„ ë¬´ì‹œí•œ ê²°ê³¼**
- ì´ˆë°˜ í•™ìŠµ ì§€ì—° â†’ ì„±ëŠ¥ ì €í•˜ ê¸°ì—¬

**êµí›ˆ**: **ì´ì „ ì‹¤í—˜ì˜ ë°œê²¬ì„ ì‹ ë¢°í•˜ê³  ì ìš©í•´ì•¼ í•¨**

#### âš ï¸ 2. ì´ˆê¸° ì„¤ì •ì˜ í•¨ì •

**ì‹¤í—˜ 2 ê´€ì°°:**
- Trial 4ì˜ ëª¨ë“  íŒŒë¼ë¯¸í„°ê°€ ì´ˆê¸° ì„¤ì •ê°’ê³¼ ë™ì¼
- Optunaê°€ ë‹¤ë¥¸ ì¡°í•©ì„ ì¶©ë¶„íˆ íƒìƒ‰í•˜ì§€ ëª»í•¨
- **ë¡œì»¬ ìµœì ê°’ì— ê°‡í˜**

**ì›ì¸:**
- Trial ìˆ˜ ë¶€ì¡± (13 trials)
- ì´ˆê¸° ì„¤ì •ì´ ì´ë¯¸ ì¢‹ì€ ì§€ì 
- TPE Samplerê°€ ì£¼ë³€ë§Œ íƒìƒ‰

**êµí›ˆ**: **ë” ë§ì€ trialsë¡œ ì¶©ë¶„í•œ íƒìƒ‰ í•„ìš”**

#### âš ï¸ 3. Scheduler ì„ íƒì˜ ì˜í–¥

**ì‹¤í—˜ 1 ì¦ëª…**: Cosineì´ Polynomialë³´ë‹¤ í‰ê·  5% ìš°ìˆ˜
**ì‹¤í—˜ 2 ìµœì ê°’**: Polynomial ì„ íƒ

**ë¶„ì„:**
- ì‹¤í—˜ 2ì—ì„œ Cosine trials ì¶©ë¶„íˆ íƒìƒ‰ ëª»í•¨
- Trial 4ê°€ ìš°ì—°íˆ ì¢‹ì€ íŒŒë¼ë¯¸í„° ì¡°í•© ë°œê²¬
- í•˜ì§€ë§Œ **Cosineìœ¼ë¡œ í–ˆë‹¤ë©´ ë” ë‚˜ì€ ì„±ëŠ¥ ê°€ëŠ¥**

**êµí›ˆ**: **í†µê³„ì ìœ¼ë¡œ ìš°ìˆ˜í•œ ì„ íƒ (Cosine) ìš°ì„ **

### 8.3 ìµœì¢… ê¶Œì¥ í•˜ì´í¼íŒŒë¼ë¯¸í„°

**ë‘ ì‹¤í—˜ì˜ ë°œê²¬ì„ ì¢…í•©í•œ ìµœì  ì„¤ì •:**

```json
{
  "learning_rate": 8.5e-5,
  "num_epochs": 7,
  "warmup_ratio": 0.001,
  "weight_decay": 0.095,
  "scheduler_type": "cosine",
  "num_beams": 4,
  "length_penalty": 0.93
}
```

**ê·¼ê±°:**
- **learning_rate**: ë‘ ì‹¤í—˜ ìµœì ê°’ì˜ ì¤‘ê°„ (7.57e-5ì™€ 9.14e-5 ì‚¬ì´)
- **num_epochs**: ì‹¤í—˜ 1ì˜ ìµœì ê°’ (7), ì‹œê°„ íš¨ìœ¨ì 
- **warmup_ratio**: ì‹¤í—˜ 1ì˜ ë°œê²¬ (ê±°ì˜ 0%)
- **weight_decay**: ë‘ ì‹¤í—˜ í‰ê·  (0.092 + 0.0995) / 2 = 0.095
- **scheduler_type**: ë‘ ì‹¤í—˜ ëª¨ë‘ Cosine ìš°ìˆ˜
- **num_beams**: ì‹¤í—˜ 1ì˜ ìµœì ê°’ (4), íš¨ìœ¨ì 
- **length_penalty**: ë‘ ì‹¤í—˜ í‰ê·  (0.921 + 0.938) / 2 = 0.93

**ì˜ˆìƒ ì„±ëŠ¥:**
```
ROUGE-L F1: 0.465 ~ 0.470 (46.5% ~ 47.0%)
í•™ìŠµ ì‹œê°„: ì•½ 10ë¶„ (7 epochs)
```

---

## 9. ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­

### 9.1 í•µì‹¬ ë°œê²¬ ìš”ì•½

#### âœ… ì„±ëŠ¥ ë¹„êµ

| ì‹¤í—˜ | ìµœê³  ì„±ëŠ¥ | í‰ê·  ì„±ëŠ¥ | í‘œì¤€í¸ì°¨ | ìµœì  Trial ìœ„ì¹˜ |
|------|----------|----------|----------|----------------|
| **ì‹¤í—˜ 1 (094051)** | **0.4616** | 0.4393 | 0.0199 | 78.6% |
| **ì‹¤í—˜ 2 (154616)** | 0.4598 | 0.4410 | 0.0193 | 30.8% |
| **ì°¨ì´** | **-0.18%** | +0.17% | -0.06% | ì¡°ê¸° ë°œê²¬ |

#### âœ… ì¼ê´€ëœ ë°œê²¬ (ë‘ ì‹¤í—˜ ê³µí†µ)

1. **Learning Rate**: 7.5e-5 ~ 9.5e-5 ìµœì 
2. **Scheduler**: Cosineì´ ëª…í™•íˆ ìš°ìˆ˜ (+5%)
3. **Weight Decay**: 0.09 ~ 0.10 ê°•í•œ ì •ê·œí™” í•„ìˆ˜
4. **Epochs**: 7-8 epochsê°€ Sweet Spot

#### âš ï¸ ì‹¤í—˜ 2ì˜ ë¬¸ì œì 

1. **Scheduler ì„ íƒ**: Polynomial ëŒ€ì‹  Cosine ì‚¬ìš© ì‹œ ë” ë‚˜ì€ ì„±ëŠ¥ ê¸°ëŒ€
2. **ê³¼ë„í•œ Warmup**: 12% â†’ 0%ë¡œ ì¡°ì • í•„ìš”
3. **ê³¼ë‹¤í•œ Epochs**: 10 â†’ 7ë¡œ ë‹¨ì¶• ê°€ëŠ¥
4. **ë¹„íš¨ìœ¨ì  Beam**: 6 â†’ 4ë¡œ ì¤„ì—¬ë„ ì„±ëŠ¥ ìœ ì§€ ê°€ëŠ¥

### 9.2 ê¶Œì¥ì‚¬í•­

#### ğŸ¯ ì¦‰ì‹œ ì ìš© ê°€ëŠ¥ (ë‹¤ìŒ ì‹¤í—˜)

**ì „ëµ 1: ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„°ë¡œ ë‹¨ì¼ ëª¨ë¸ í•™ìŠµ**

```bash
python scripts/train.py \
  --mode single \
  --models kobart \
  --epochs 7 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --learning_rate 8.5e-5 \
  --warmup_ratio 0.001 \
  --weight_decay 0.095 \
  --scheduler_type cosine \
  --max_grad_norm 1.0 \
  --label_smoothing 0.1 \
  --num_beams 4 \
  --length_penalty 0.93 \
  --max_new_tokens 100 \
  --min_new_tokens 30 \
  --repetition_penalty 1.5 \
  --no_repeat_ngram_size 3 \
  --experiment_name kobart_best_single \
  --seed 42

# ì˜ˆìƒ ì‹œê°„: 10ë¶„
# ì˜ˆìƒ ì„±ëŠ¥: ROUGE-L F1 = 0.465+
```

**ì „ëµ 2: K-Fold + ìµœì  íŒŒë¼ë¯¸í„° (ìµœê°• ì¡°í•©)**

```bash
python scripts/train.py \
  --mode kfold \
  --models kobart \
  --k_folds 5 \
  --epochs 7 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --learning_rate 8.5e-5 \
  --warmup_ratio 0.001 \
  --weight_decay 0.095 \
  --scheduler_type cosine \
  --max_grad_norm 1.0 \
  --label_smoothing 0.1 \
  --num_beams 4 \
  --length_penalty 0.93 \
  --max_new_tokens 100 \
  --repetition_penalty 1.5 \
  --no_repeat_ngram_size 3 \
  --use_augmentation \
  --augmentation_ratio 0.5 \
  --augmentation_methods back_translation paraphrase \
  --experiment_name kobart_kfold_ultimate \
  --seed 42

# ì˜ˆìƒ ì‹œê°„: 50ë¶„ (5 folds Ã— 10ë¶„)
# ì˜ˆìƒ ì„±ëŠ¥: ROUGE-L F1 = 0.475 ~ 0.485 (ì•™ìƒë¸” íš¨ê³¼ +2~3%)
```

#### ğŸ”¬ ì¶”ê°€ ìµœì í™” (ì„ íƒì )

**ì „ëµ 3: Optuna ì¬ì‹¤í–‰ (ë” ê¹Šì€ íƒìƒ‰)**

```bash
python scripts/train.py \
  --mode optuna \
  --models kobart \
  --optuna_trials 30 \
  --optuna_timeout 14400 \
  --epochs 8 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --learning_rate 8.5e-5 \
  --warmup_ratio 0.001 \
  --weight_decay 0.095 \
  --scheduler_type cosine \
  --max_grad_norm 1.0 \
  --label_smoothing 0.1 \
  --num_beams 4 \
  --length_penalty 0.93 \
  --experiment_name kobart_optuna_round3 \
  --seed 42

# ì˜ˆìƒ ì‹œê°„: 4ì‹œê°„ (30 trials)
# ëª©í‘œ: ë” ë‚˜ì€ ì¡°í•© ë°œê²¬ (ROUGE-L F1 0.470+)
```

**íƒìƒ‰ ê³µê°„ ì¶•ì†Œ ì œì•ˆ:**

```python
# src/optimization/optuna_optimizer.py ìˆ˜ì •
learning_rate: 7.0e-5 ~ 1.0e-4 (log-uniform)  # ë²”ìœ„ ì¢í˜
num_epochs: 6 ~ 8                              # 7 ì£¼ë³€ ì§‘ì¤‘
warmup_ratio: 0.0 ~ 0.01                       # ê±°ì˜ 0
weight_decay: 0.08 ~ 0.10                      # ë†’ì€ ë²”ìœ„ë§Œ
scheduler_type: [cosine, cosine_with_restarts] # ìš°ìˆ˜í•œ ê²ƒë§Œ
num_beams: [4, 6]                              # íš¨ìœ¨ì  ë²”ìœ„
length_penalty: 0.85 ~ 0.95                    # ë²”ìœ„ ì¢í˜
```

### 9.3 ì˜ˆìƒ ìµœì¢… ì„±ëŠ¥

```mermaid
graph LR
    A[í˜„ì¬ ìµœê³ <br/>ì‹¤í—˜ 1: 0.4616] --> B[ìµœì  íŒŒë¼ë¯¸í„°<br/>ë‹¨ì¼ ëª¨ë¸<br/>ì˜ˆìƒ: 0.465~0.470]
    B --> C[K-Fold 5<br/>ì•™ìƒë¸”<br/>ì˜ˆìƒ: 0.475~0.485]
    C --> D[ì¶”ë¡  ê³ ë„í™”<br/>Solar + HF<br/>ì˜ˆìƒ: 0.490~0.510]
    D --> E[ìµœì¢… ëª©í‘œ<br/>ROUGE-L F1<br/>0.50+]

    style A fill:#81c784,stroke:#2e7d32,color:#000
    style B fill:#a5d6a7,stroke:#388e3c,color:#000
    style C fill:#66bb6a,stroke:#2e7d32,color:#fff
    style D fill:#4caf50,stroke:#1b5e20,color:#fff
    style E fill:#2e7d32,stroke:#1b5e20,color:#fff
```

**ë‹¨ê³„ë³„ ê°œì„  ë¡œë“œë§µ:**

1. **í˜„ì¬**: 0.4616 (ì‹¤í—˜ 1 ìµœê³  ì„±ëŠ¥)
2. **ìµœì  ë‹¨ì¼ ëª¨ë¸**: 0.465 ~ 0.470 (+1~2%)
3. **K-Fold ì•™ìƒë¸”**: 0.475 ~ 0.485 (+2~3%)
4. **ì¶”ë¡  ìµœì í™”**: 0.490 ~ 0.510 (+3~5%)
5. **ìµœì¢… ëª©í‘œ**: **0.50+ (50% ì´ìƒ)**

### 9.4 ì‹¤í—˜ ê°„ êµí›ˆ

#### ğŸ“š ë°°ìš´ ì 

1. **ì´ì „ ì‹¤í—˜ì˜ ë°œê²¬ì„ ì‹ ë¢°í•˜ê³  í™œìš©**
   - ì‹¤í—˜ 1ì—ì„œ Cosine > Polynomial ì¦ëª…
   - ì‹¤í—˜ 2ëŠ” ì´ë¥¼ ë¬´ì‹œ â†’ ì„±ëŠ¥ ì €í•˜

2. **ì¶©ë¶„í•œ íƒìƒ‰ì˜ ì¤‘ìš”ì„±**
   - 13~14 trialsë¡œëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆìŒ
   - 20~30 trials ê¶Œì¥

3. **í†µê³„ì  íŒ¨í„´ ìš°ì„ **
   - ë‹¨ì¼ trial ê²°ê³¼ë³´ë‹¤ í‰ê·  ì„±ëŠ¥ ì¤‘ìš”
   - Trial 4ê°€ 1ìœ„ì§€ë§Œ Cosineì´ í‰ê· ì ìœ¼ë¡œ ìš°ìˆ˜

4. **ì‹œê°„ íš¨ìœ¨ì„± ê³ ë ¤**
   - 7 epochs vs 10 epochs
   - 30% ì‹œê°„ ì ˆì•½í•˜ë©´ì„œ ë” ë‚˜ì€ ì„±ëŠ¥ ê°€ëŠ¥

#### ğŸ“ ë‹¤ìŒ ì‹¤í—˜ì„ ìœ„í•œ ê°€ì´ë“œ

1. **Config íŒŒì¼ ì—…ë°ì´íŠ¸**
   ```yaml
   # configs/models/kobart.yaml
   training:
     learning_rate: 8.5e-5
     epochs: 7
     warmup_ratio: 0.001
     weight_decay: 0.095
     lr_scheduler_type: cosine

   inference:
     num_beams: 4
     length_penalty: 0.93
   ```

2. **ëª…ë ¹í–‰ ì¸ì ìš°ì„ ìˆœìœ„**
   - Config < ëª…ë ¹í–‰ ì¸ì < Optuna íƒìƒ‰
   - ëª…í™•í•œ ìš°ì„ ìˆœìœ„ ì„¤ì • í•„ìš”

3. **ì‹¤í—˜ ë¬¸ì„œí™”**
   - ëª¨ë“  ì‹¤í—˜ë§ˆë‹¤ ìƒì„¸ ë¶„ì„ ë¬¸ì„œ ì‘ì„±
   - ì´ì „ ì‹¤í—˜ê³¼ì˜ ë¹„êµ í•„ìˆ˜

---

## 10. ì°¸ê³  ìë£Œ

### 10.1 ì‹¤í—˜ íŒŒì¼ ìœ„ì¹˜

```
experiments/20251014/20251014_154616_kobart_ultimate_optuna/
â”œâ”€â”€ command.txt                # ì‹¤í–‰ ëª…ë ¹ì–´
â”œâ”€â”€ train.log                  # ì „ì²´ í•™ìŠµ ë¡œê·¸ (ìƒì„± ì‹œ)
â”œâ”€â”€ best_params.json           # ìµœì  í•˜ì´í¼íŒŒë¼ë¯¸í„°
â”œâ”€â”€ all_trials.csv             # ì „ì²´ 13 trials ê²°ê³¼
â”œâ”€â”€ study_stats.json           # Optuna í†µê³„
â””â”€â”€ optuna_results.json        # Optuna ê²°ê³¼ ìš”ì•½
```

### 10.2 ê´€ë ¨ ë¬¸ì„œ

- `docs/experiments/20251014_094051_kobart_ultimate_optuna_ì‹¤í—˜ë¶„ì„.md`: ì´ì „ ì‹¤í—˜ ë¶„ì„
- `docs/ëª¨ë“ˆí™”/04_02_KoBART_ë‹¨ì¼ëª¨ë¸_ìµœê°•_ì„±ëŠ¥_ì „ëµ.md`: ì „ëµ ê°€ì´ë“œ
- `configs/models/kobart.yaml`: KoBART ì„¤ì • íŒŒì¼

### 10.3 ë¹„êµ ë¶„ì„ ìš”ì•½ í…Œì´ë¸”

| í•­ëª© | ì‹¤í—˜ 1 (094051) | ì‹¤í—˜ 2 (154616) | ê¶Œì¥ê°’ |
|------|----------------|----------------|--------|
| **Learning Rate** | 9.14e-5 | 7.57e-5 | **8.5e-5** |
| **Epochs** | 7 | 10 | **7** |
| **Warmup Ratio** | 0.00136 | 0.1196 | **0.001** |
| **Weight Decay** | 0.0995 | 0.0922 | **0.095** |
| **Scheduler** | cosine | polynomial | **cosine** |
| **Beams** | 4 | 6 | **4** |
| **Length Penalty** | 0.938 | 0.921 | **0.93** |
| **ROUGE-L F1** | **0.4616** | 0.4598 | **0.465+** (ì˜ˆìƒ) |

### 10.4 í•˜ì´í¼íŒŒë¼ë¯¸í„° ë¯¼ê°ë„ ìˆœìœ„

**ì„±ëŠ¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ìˆœì„œ:**

1. **Learning Rate** â­â­â­â­â­ (ê°€ì¥ ì¤‘ìš”)
2. **Weight Decay** â­â­â­â­â­ (ë§¤ìš° ì¤‘ìš”)
3. **Scheduler Type** â­â­â­â­ (ì¤‘ìš”)
4. **Epochs** â­â­â­â­ (ì¤‘ìš”)
5. **Num Beams** â­â­â­ (ë³´í†µ)
6. **Length Penalty** â­â­ (ì†Œí­ ì˜í–¥)
7. **Warmup Ratio** â­ (ê±°ì˜ ì˜í–¥ ì—†ìŒ)

### 10.5 Optuna ì°¸ê³  ìë£Œ

- [Optuna Documentation](https://optuna.readthedocs.io/)
- TPE Sampler: Tree-structured Parzen Estimator
- Median Pruner: ì¤‘ê°„ê°’ ê¸°ë°˜ ì¡°ê¸° ì¢…ë£Œ
- [Optuna Best Practices](https://optuna.readthedocs.io/en/stable/tutorial/10_key_features/003_efficient_optimization_algorithms.html)

---

**ì‘ì„±ì¼**: 2025-10-14
**ì‹¤í—˜ ìƒíƒœ**: âœ… ì •ìƒ ì™„ë£Œ, ì´ì „ ì‹¤í—˜ ëŒ€ë¹„ ë¯¸ì„¸ í•˜ë½ (-0.18%)
**ê¶Œì¥ ì¡°ì¹˜**: ì‹¤í—˜ 1ì˜ ìµœì  íŒŒë¼ë¯¸í„° + Cosine ìŠ¤ì¼€ì¤„ëŸ¬ ì¡°í•© ì‚¬ìš©
