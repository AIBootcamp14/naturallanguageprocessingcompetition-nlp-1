# ì‹¤í—˜ ë¶„ì„ ë³´ê³ ì„œ: KoBART K-Fold ê· í˜• ì „ëµ í•™ìŠµ

> **ì‹¤í—˜ ID**: 20251014_090813_kobart_balanced
> **ì‹¤í–‰ ì¼ì‹œ**: 2025-10-14 09:08:13
> **ì‹¤í–‰ ëª¨ë“œ**: K-Fold (5-Fold Cross Validation)
> **ì‹¤í—˜ ìƒíƒœ**: âœ… ì„±ê³µ (ì „ì²´ 5 Fold ì™„ë£Œ)

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹¤í—˜ ê°œìš”](#1-ì‹¤í—˜-ê°œìš”)
2. [ì‹¤í—˜ ì„¤ì •](#2-ì‹¤í—˜-ì„¤ì •)
3. [í•™ìŠµ ì§€í‘œ ë¶„ì„](#3-í•™ìŠµ-ì§€í‘œ-ë¶„ì„)
4. [Foldë³„ ìƒì„¸ ê²°ê³¼](#4-foldë³„-ìƒì„¸-ê²°ê³¼)
5. [ì¢…í•© ë¶„ì„](#5-ì¢…í•©-ë¶„ì„)
6. [ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­](#6-ê²°ë¡ -ë°-ê¶Œì¥ì‚¬í•­)
7. [ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´](#7-ë‹¤ìŒ-ë‹¨ê³„-ì•ˆë‚´)

---

## 1. ì‹¤í—˜ ê°œìš”

### 1.1 ì‹¤í—˜ ëª©ì 

ë³¸ ì‹¤í—˜ì€ **ì „ëµ 2: ê· í˜•ì¡íŒ ê³ ì„±ëŠ¥ (K-Fold + ì¤‘ê°„ Epoch)** ì „ëµì„ ì‚¬ìš©í•˜ì—¬ KoBART ëª¨ë¸ì˜ ì•ˆì •ì ì´ê³  ì¼ë°˜í™”ëœ ì„±ëŠ¥ì„ í™•ë³´í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

### 1.2 ì‹¤í—˜ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph Input["ğŸ“¥ ì…ë ¥"]
        A[KoBART ëª¨ë¸<br/>gogamza/kobart-base-v2]
        B[í•™ìŠµ ë°ì´í„°<br/>K-Fold ë¶„í• ]
        C[ì¦ê°• ê¸°ë²•<br/>Back Translation + Paraphrase]
    end

    subgraph Training["ğŸ”„ K-Fold í•™ìŠµ"]
        D[Fold 1<br/>Epoch 15]
        E[Fold 2<br/>Epoch 7]
        F[Fold 3<br/>Epoch 11]
        G[Fold 4<br/>Epoch 10]
        H[Fold 5<br/>Epoch 12]
    end

    subgraph Correction["ğŸ”§ í›„ì²˜ë¦¬"]
        I[Solar API<br/>í’ˆì§ˆ í–¥ìƒ]
        J[Pretrained Correction<br/>2ê°œ ëª¨ë¸]
    end

    subgraph Output["ğŸ“Š ì¶œë ¥"]
        K[5ê°œ Fold ëª¨ë¸]
        L[ìµœì¢… í‰ê°€ ì§€í‘œ]
        M[ì•™ìƒë¸” ì¤€ë¹„]
    end

    A --> D
    A --> E
    A --> F
    A --> G
    A --> H
    B --> D
    B --> E
    B --> F
    B --> G
    B --> H
    C --> D
    C --> E
    C --> F
    C --> G
    C --> H

    D --> I
    E --> I
    F --> I
    G --> I
    H --> I

    I --> J
    J --> K
    K --> L
    L --> M

    style Input fill:#e3f2fd,stroke:#1976d2,color:#000
    style Training fill:#fff3e0,stroke:#f57c00,color:#000
    style Correction fill:#e8f5e9,stroke:#388e3c,color:#000
    style Output fill:#c8e6c9,stroke:#2e7d32,color:#000
```

### 1.3 ì „ëµ íŠ¹ì§•

- **K-Fold Cross Validation**: 5ê°œ foldë¡œ ë°ì´í„° ë¶„í• í•˜ì—¬ ëª¨ë¸ ì¼ë°˜í™” ì„±ëŠ¥ í–¥ìƒ
- **ì¤‘ê°„ Epoch (15)**: ê³¼ì í•© ë°©ì§€ì™€ í•™ìŠµ ì‹œê°„ ê· í˜•
- **Early Stopping**: Patience=3ìœ¼ë¡œ ìµœì  ì²´í¬í¬ì¸íŠ¸ ìë™ ì €ì¥
- **ë°ì´í„° ì¦ê°•**: Back Translation + Paraphrase (50% ë¹„ìœ¨)
- **Solar API**: í’ˆì§ˆ ê¸°ë°˜ í›„ì²˜ë¦¬ ì „ëµ
- **Pretrained Correction**: 2ê°œ ëª¨ë¸ ì•™ìƒë¸” ë³´ì •

---

## 2. ì‹¤í—˜ ì„¤ì •

### 2.1 ëª¨ë¸ ì„¤ì •

```python
{
    "model": "gogamza/kobart-base-v2",
    "mode": "kfold",
    "k_folds": 5,
    "fold_seed": 42
}
```

### 2.2 í•™ìŠµ í•˜ì´í¼íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|---------|-----|------|
| **Epochs** | 15 | í•™ìŠµ ë°˜ë³µ íšŸìˆ˜ |
| **Batch Size** | 16 | ë°°ì¹˜ í¬ê¸° |
| **Gradient Accumulation Steps** | 10 | ì‹¤ì§ˆì  ë°°ì¹˜ í¬ê¸° = 160 |
| **Learning Rate** | 5e-5 | í•™ìŠµë¥  |
| **Warmup Ratio** | 0.1 | ì›Œë°ì—… ë¹„ìœ¨ |
| **Weight Decay** | 0.01 | ê°€ì¤‘ì¹˜ ê°ì‡  |
| **Max Grad Norm** | 1.0 | ê·¸ë˜ë””ì–¸íŠ¸ í´ë¦¬í•‘ |
| **Label Smoothing** | 0.1 | ë ˆì´ë¸” ìŠ¤ë¬´ë”© |

### 2.3 ìƒì„± íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|---------|-----|------|
| **Max New Tokens** | 100 | ìµœëŒ€ ìƒì„± í† í° ìˆ˜ |
| **Min New Tokens** | 30 | ìµœì†Œ ìƒì„± í† í° ìˆ˜ |
| **Num Beams** | 5 | ë¹” ì„œì¹˜ í¬ê¸° |
| **Repetition Penalty** | 1.5 | ë°˜ë³µ íŒ¨ë„í‹° |
| **Length Penalty** | 1.0 | ê¸¸ì´ íŒ¨ë„í‹° |
| **No Repeat Ngram Size** | 3 | N-gram ë°˜ë³µ ë°©ì§€ |

### 2.4 ë°ì´í„° ì¦ê°• ì„¤ì •

```python
{
    "use_augmentation": True,
    "augmentation_ratio": 0.5,
    "augmentation_methods": ["back_translation", "paraphrase"]
}
```

### 2.5 í›„ì²˜ë¦¬ ì„¤ì •

```python
{
    "use_solar_api": True,
    "use_pretrained_correction": True,
    "correction_models": [
        "gogamza/kobart-base-v2",
        "digit82/kobart-summarization"
    ],
    "correction_strategy": "quality_based",
    "correction_threshold": 0.3
}
```

### 2.6 ì‹¤í—˜ í™˜ê²½

```yaml
ì‹¤í—˜ëª…: kobart_balanced
ì‹œë“œ: 42
í‰ê°€ ì „ëµ: epoch
ì €ì¥ ì „ëµ: Early Stopping (patience=3)
í‰ê°€ ì§€í‘œ: ROUGE-Sum
```

---

## 3. í•™ìŠµ ì§€í‘œ ë¶„ì„

### 3.1 ì „ì²´ Fold í•™ìŠµ ì‹œê°„

```mermaid
gantt
    title K-Fold í•™ìŠµ íƒ€ì„ë¼ì¸
    dateFormat HH:mm
    section Fold 1
    í•™ìŠµ ì§„í–‰           :09:08, 2h04m
    ìµœì¢… í‰ê°€           :11:12, 6m
    section Fold 2
    í•™ìŠµ ì§„í–‰           :11:12, 0h52m
    ìµœì¢… í‰ê°€           :12:04, 6m
    section Fold 3
    í•™ìŠµ ì§„í–‰           :12:10, 1h49m
    ìµœì¢… í‰ê°€           :13:59, 6m
    section Fold 4
    í•™ìŠµ ì§„í–‰           :14:00, 1h39m
    ìµœì¢… í‰ê°€           :15:39, 6m
    section Fold 5
    í•™ìŠµ ì§„í–‰           :15:45, 2h04m
    ìµœì¢… í‰ê°€           :17:49, 6m
```

**ì´ í•™ìŠµ ì‹œê°„**: ì•½ 8ì‹œê°„ 47ë¶„

### 3.2 Foldë³„ ìµœì¢… ROUGE ì ìˆ˜

| Fold | ROUGE-1 | ROUGE-2 | ROUGE-L | ROUGE-Sum | Best Epoch |
|------|---------|---------|---------|-----------|------------|
| **Fold 1** | 0.4685 | 0.2979 | 0.4570 | **1.2233** | 12 |
| **Fold 2** | 0.4651 | 0.2907 | 0.4520 | **1.2078** | 4 |
| **Fold 3** | 0.4694 | 0.2991 | 0.4579 | **1.2264** | 11 |
| **Fold 4** | 0.4723 | 0.3038 | 0.4591 | **1.2352** | 10 |
| **Fold 5** | 0.4615 | 0.2960 | 0.4500 | **1.2075** | 12 |
| **í‰ê· ** | **0.4674** | **0.2975** | **0.4552** | **1.2200** | **9.8** |
| **í‘œì¤€í¸ì°¨** | 0.0038 | 0.0044 | 0.0036 | 0.0106 | 3.0 |

### 3.3 ì„±ëŠ¥ ë¶„í¬ ì‹œê°í™”

```mermaid
graph LR
    A[Fold 1<br/>1.2233] -->|+0.0033| M[í‰ê· <br/>1.2200]
    B[Fold 2<br/>1.2078] -->|-0.0122| M
    C[Fold 3<br/>1.2264] -->|+0.0064| M
    D[Fold 4<br/>1.2352] -->|+0.0152| M
    E[Fold 5<br/>1.2075] -->|-0.0125| M

    M --> F[í‘œì¤€í¸ì°¨<br/>0.0106]

    style D fill:#c8e6c9,stroke:#2e7d32,color:#000
    style B fill:#ffcdd2,stroke:#c62828,color:#000
    style E fill:#ffcdd2,stroke:#c62828,color:#000
    style M fill:#fff9c4,stroke:#f57f17,color:#000
```

**ì£¼ìš” ê´€ì°°**:
- âœ… **Fold 4ê°€ ìµœê³  ì„±ëŠ¥**: ROUGE-Sum 1.2352
- âœ… **ë‚®ì€ í‘œì¤€í¸ì°¨**: 0.0106 (ì¼ê´€ì„± ë†’ìŒ)
- âœ… **ëª¨ë“  Fold 1.20 ì´ìƒ**: ì•ˆì •ì  ì„±ëŠ¥ í™•ë³´

---

## 4. Foldë³„ ìƒì„¸ ê²°ê³¼

### 4.1 Fold 1 (Best: Epoch 12)

#### í•™ìŠµ ê³¡ì„ 

```mermaid
graph LR
    E1[Epoch 1<br/>1.0289] -->|+4.6%| E2[Epoch 2<br/>1.0746]
    E2 -->|+5.1%| E3[Epoch 3<br/>1.1294]
    E3 -->|+3.0%| E4[Epoch 4<br/>1.1635]
    E4 -->|-1.0%| E5[Epoch 5<br/>1.1521]
    E5 -->|+0.0%| E6[Epoch 6<br/>1.1521]
    E6 -->|+2.4%| E7[Epoch 7<br/>1.1891]
    E7 -->|-1.5%| E8[Epoch 8<br/>1.1715]
    E8 -->|+3.3%| E9[Epoch 9<br/>1.2109]
    E9 -->|-1.4%| E10[Epoch 10<br/>1.1947]
    E10 -->|+1.1%| E11[Epoch 11<br/>1.2075]
    E11 -->|+1.3%| E12[Epoch 12<br/>1.2233]
    E12 -->|-0.9%| E13[Epoch 13<br/>1.2120]
    E13 -->|-0.6%| E14[Epoch 14<br/>1.2047]
    E14 -->|-0.1%| E15[Epoch 15<br/>1.2034]

    style E12 fill:#c8e6c9,stroke:#2e7d32,color:#000
```

**Best Checkpoint**: `checkpoint-7476` (Epoch 12)
- ROUGE-1: 0.4685
- ROUGE-2: 0.2979
- ROUGE-L: 0.4570
- ROUGE-Sum: **1.2233**

**ê´€ì°°**:
- Epoch 12ì—ì„œ ìµœê³  ì„±ëŠ¥ ë‹¬ì„± í›„ Early Stopping ì‘ë™
- ì „ì²´ 15 epoch ì™„ë£Œ (patience ì¹´ìš´í„°: 3)

### 4.2 Fold 2 (Best: Epoch 4) âš¡

#### í•™ìŠµ ê³¡ì„ 

```mermaid
graph LR
    E1[Epoch 1<br/>1.0312] -->|+3.6%| E2[Epoch 2<br/>1.0679]
    E2 -->|+7.1%| E3[Epoch 3<br/>1.1432]
    E3 -->|+5.6%| E4[Epoch 4<br/>1.2078]
    E4 -->|-4.7%| E5[Epoch 5<br/>1.1520]
    E5 -->|+2.5%| E6[Epoch 6<br/>1.1810]
    E6 -->|+0.2%| E7[Epoch 7<br/>1.1839]

    style E4 fill:#c8e6c9,stroke:#2e7d32,color:#000
```

**Best Checkpoint**: `checkpoint-2492` (Epoch 4)
- ROUGE-1: 0.4651
- ROUGE-2: 0.2907
- ROUGE-L: 0.4520
- ROUGE-Sum: **1.2078**

**ê´€ì°°**:
- âš¡ **ê°€ì¥ ë¹ ë¥¸ ìˆ˜ë ´**: Epoch 4ì—ì„œ ìµœì ì  ë„ë‹¬
- Epoch 7ì—ì„œ Early Stoppingìœ¼ë¡œ ì¡°ê¸° ì¢…ë£Œ

### 4.3 Fold 3 (Best: Epoch 11)

#### í•™ìŠµ ê³¡ì„ 

```mermaid
graph LR
    E1[Epoch 1<br/>1.0437] -->|+3.8%| E2[Epoch 2<br/>1.0829]
    E2 -->|+3.8%| E3[Epoch 3<br/>1.1241]
    E3 -->|+3.1%| E4[Epoch 4<br/>1.1595]
    E4 -->|+0.5%| E5[Epoch 5<br/>1.1658]
    E5 -->|-0.3%| E6[Epoch 6<br/>1.1622]
    E6 -->|+0.4%| E7[Epoch 7<br/>1.1667]
    E7 -->|+3.3%| E8[Epoch 8<br/>1.2056]
    E8 -->|-2.7%| E9[Epoch 9<br/>1.1748]
    E9 -->|+4.1%| E10[Epoch 10<br/>1.2227]
    E10 -->|+0.3%| E11[Epoch 11<br/>1.2264]
    E11 -->|-0.7%| E12[Epoch 12<br/>1.2184]
    E12 -->|-0.8%| E13[Epoch 13<br/>1.2085]
    E13 -->|+1.4%| E14[Epoch 14<br/>1.2255]

    style E11 fill:#c8e6c9,stroke:#2e7d32,color:#000
```

**Best Checkpoint**: `checkpoint-6853` (Epoch 11)
- ROUGE-1: 0.4694
- ROUGE-2: 0.2991
- ROUGE-L: 0.4579
- ROUGE-Sum: **1.2264**

**ê´€ì°°**:
- Epoch 11ì—ì„œ ìµœê³  ì„±ëŠ¥ ë‹¬ì„±
- Epoch 14ì—ì„œ Early Stoppingìœ¼ë¡œ ì¢…ë£Œ

### 4.4 Fold 4 (Best: Epoch 10) ğŸ†

#### í•™ìŠµ ê³¡ì„ 

```mermaid
graph LR
    E1[Epoch 1<br/>1.0151] -->|+11.5%| E2[Epoch 2<br/>1.1321]
    E2 -->|+0.9%| E3[Epoch 3<br/>1.1420]
    E3 -->|+2.7%| E4[Epoch 4<br/>1.1732]
    E4 -->|+2.8%| E5[Epoch 5<br/>1.2062]
    E5 -->|-0.8%| E6[Epoch 6<br/>1.1957]
    E6 -->|+1.0%| E7[Epoch 7<br/>1.2071]
    E7 -->|+1.7%| E8[Epoch 8<br/>1.2280]
    E8 -->|-0.4%| E9[Epoch 9<br/>1.2230]
    E9 -->|+1.0%| E10[Epoch 10<br/>1.2352]
    E10 -->|-2.4%| E11[Epoch 11<br/>1.2070]
    E11 -->|+2.3%| E12[Epoch 12<br/>1.2348]
    E12 -->|-2.6%| E13[Epoch 13<br/>1.2334]

    style E10 fill:#c8e6c9,stroke:#2e7d32,color:#000
```

**Best Checkpoint**: `checkpoint-6230` (Epoch 10)
- ROUGE-1: 0.4723 ğŸ†
- ROUGE-2: 0.3038 ğŸ†
- ROUGE-L: 0.4591 ğŸ†
- ROUGE-Sum: **1.2352** ğŸ†

**ê´€ì°°**:
- ğŸ† **ì „ì²´ Fold ì¤‘ ìµœê³  ì„±ëŠ¥**
- ROUGE-2 ì ìˆ˜ê°€ íŠ¹íˆ ìš°ìˆ˜ (0.3038)
- Epoch 13ì—ì„œ Early Stoppingìœ¼ë¡œ ì¢…ë£Œ

### 4.5 Fold 5 (Best: Epoch 12)

#### í•™ìŠµ ê³¡ì„ 

```mermaid
graph LR
    E1[Epoch 1<br/>1.0681] -->|+0.3%| E2[Epoch 2<br/>1.0712]
    E2 -->|+7.8%| E3[Epoch 3<br/>1.1544]
    E3 -->|-1.7%| E4[Epoch 4<br/>1.1353]
    E4 -->|+1.1%| E5[Epoch 5<br/>1.1483]
    E5 -->|+1.3%| E6[Epoch 6<br/>1.1614]
    E6 -->|-0.1%| E7[Epoch 7<br/>1.1599]
    E7 -->|+0.8%| E8[Epoch 8<br/>1.1696]
    E8 -->|+0.1%| E9[Epoch 9<br/>1.1704]
    E9 -->|+2.2%| E10[Epoch 10<br/>1.1958]
    E10 -->|+0.1%| E11[Epoch 11<br/>1.1970]
    E11 -->|+0.9%| E12[Epoch 12<br/>1.2075]
    E12 -->|-0.6%| E13[Epoch 13<br/>1.2002]
    E13 -->|-0.8%| E14[Epoch 14<br/>1.1846]
    E14 -->|-0.1%| E15[Epoch 15<br/>1.1831]

    style E12 fill:#c8e6c9,stroke:#2e7d32,color:#000
```

**Best Checkpoint**: `checkpoint-7476` (Epoch 12)
- ROUGE-1: 0.4615
- ROUGE-2: 0.2960
- ROUGE-L: 0.4500
- ROUGE-Sum: **1.2075**

**ê´€ì°°**:
- ì „ì²´ 15 epoch ì™„ë£Œ
- Epoch 12ì—ì„œ ìµœê³  ì„±ëŠ¥ í›„ ì„±ëŠ¥ í•˜ë½

---

## 5. ì¢…í•© ë¶„ì„

### 5.1 ì„±ëŠ¥ ë¹„êµ

```mermaid
graph TB
    subgraph Metrics["ì„±ëŠ¥ ì§€í‘œ"]
        R1[ROUGE-1<br/>í‰ê· : 0.4674]
        R2[ROUGE-2<br/>í‰ê· : 0.2975]
        RL[ROUGE-L<br/>í‰ê· : 0.4552]
        RS[ROUGE-Sum<br/>í‰ê· : 1.2200]
    end

    subgraph Best["ìµœê³  ì„±ëŠ¥"]
        B1[Fold 4<br/>0.4723]
        B2[Fold 4<br/>0.3038]
        B3[Fold 4<br/>0.4591]
        B4[Fold 4<br/>1.2352]
    end

    subgraph Worst["ìµœì € ì„±ëŠ¥"]
        W1[Fold 5<br/>0.4615]
        W2[Fold 2<br/>0.2907]
        W3[Fold 5<br/>0.4500]
        W4[Fold 5<br/>1.2075]
    end

    R1 -.->|+1.0%| B1
    R1 -.->|-1.3%| W1
    R2 -.->|+2.1%| B2
    R2 -.->|-2.3%| W2
    RL -.->|+0.9%| B3
    RL -.->|-1.1%| W3
    RS -.->|+1.2%| B4
    RS -.->|-1.0%| W4

    style Metrics fill:#e3f2fd,stroke:#1976d2,color:#000
    style Best fill:#c8e6c9,stroke:#2e7d32,color:#000
    style Worst fill:#ffcdd2,stroke:#c62828,color:#000
```

### 5.2 ì£¼ìš” ë°œê²¬ì‚¬í•­

#### âœ… ì„±ê³µ ìš”ì¸

1. **ì•ˆì •ì ì¸ ì„±ëŠ¥ ì¼ê´€ì„±**
   - í‘œì¤€í¸ì°¨ 0.0106ìœ¼ë¡œ ë§¤ìš° ë‚®ìŒ
   - ëª¨ë“  Foldì—ì„œ ROUGE-Sum 1.20 ì´ìƒ ë‹¬ì„±
   - Fold ê°„ ì„±ëŠ¥ ì°¨ì´ ìµœì†Œí™”

2. **Early Stoppingì˜ íš¨ê³¼**
   - Fold 2: Epoch 7ì—ì„œ ì¡°ê¸° ì¢…ë£Œ (ìµœì : Epoch 4)
   - Fold 3: Epoch 14ì—ì„œ ì¡°ê¸° ì¢…ë£Œ (ìµœì : Epoch 11)
   - Fold 4: Epoch 13ì—ì„œ ì¡°ê¸° ì¢…ë£Œ (ìµœì : Epoch 10)
   - ê³¼ì í•© ë°©ì§€ ë° í•™ìŠµ ì‹œê°„ ë‹¨ì¶•

3. **ë°ì´í„° ì¦ê°•ì˜ ê¸°ì—¬**
   - Back Translation + Paraphrase (50%)
   - ëª¨ë¸ ì¼ë°˜í™” ëŠ¥ë ¥ í–¥ìƒ
   - ì•ˆì •ì ì¸ í•™ìŠµ ê³¡ì„ 

4. **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”**
   - Gradient Accumulation (10ë‹¨ê³„) â†’ ì‹¤ì§ˆ ë°°ì¹˜ í¬ê¸° 160
   - Label Smoothing (0.1) â†’ ê³¼ì í•© ë°©ì§€
   - Learning Rate 5e-5 â†’ ì•ˆì •ì  ìˆ˜ë ´

#### âš ï¸ ê°œì„  ê°€ëŠ¥ ì˜ì—­

1. **Fold ê°„ ìˆ˜ë ´ ì†ë„ ì°¨ì´**
   - Fold 2: 4 epoch (ê°€ì¥ ë¹ ë¦„) âš¡
   - Fold 1, 5: 12 epoch (ê°€ì¥ ëŠë¦¼)
   - ë°ì´í„° ë¶„í¬ ì°¨ì´ë¡œ ì¸í•œ ì˜í–¥ ê°€ëŠ¥ì„±

2. **í›„ë°˜ Epoch ì„±ëŠ¥ ì €í•˜**
   - Fold 1, 5: Epoch 12 ì´í›„ ì„±ëŠ¥ í•˜ë½
   - Early Stopping patience ì¡°ì • í•„ìš”

3. **ROUGE-2 ì ìˆ˜ ê°œì„  ì—¬ì§€**
   - í‰ê·  0.2975 (ROUGE-1ì˜ 64%)
   - Bigram ë§¤ì¹­ ì •í™•ë„ í–¥ìƒ í•„ìš”

### 5.3 í•™ìŠµ íš¨ìœ¨ì„± ë¶„ì„

| í•­ëª© | ê°’ | ë¹„ê³  |
|-----|-----|------|
| **ì´ í•™ìŠµ ì‹œê°„** | 8ì‹œê°„ 47ë¶„ | 5 Fold ì „ì²´ |
| **Foldë‹¹ í‰ê·  ì‹œê°„** | 1ì‹œê°„ 45ë¶„ | - |
| **í‰ê·  ìˆ˜ë ´ Epoch** | 9.8 | 15 epoch ì¤‘ |
| **í•™ìŠµ íš¨ìœ¨ì„±** | 65% | (9.8/15) Ã— 100% |
| **Early Stopping ì‘ë™ë¥ ** | 60% | 3/5 Fold |

**íš¨ìœ¨ì„± í‰ê°€**: âœ… **ì–‘í˜¸**
- ì „ì²´ epochì˜ 65%ë§Œìœ¼ë¡œ ìµœì  ì„±ëŠ¥ ë‹¬ì„±
- Early Stoppingìœ¼ë¡œ ë¶ˆí•„ìš”í•œ í•™ìŠµ 35% ì ˆì•½

---

## 6. ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­

### 6.1 ì‹¤í—˜ ê²°ë¡ 

ë³¸ ì‹¤í—˜ì€ **KoBART ëª¨ë¸ì˜ K-Fold í•™ìŠµ ì „ëµ**ì„ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.

#### í•µì‹¬ ì„±ê³¼

| ì§€í‘œ | ê²°ê³¼ | í‰ê°€ |
|------|------|------|
| **í‰ê·  ROUGE-Sum** | 1.2200 | âœ… ìš°ìˆ˜ |
| **í‘œì¤€í¸ì°¨** | 0.0106 | âœ… ì¼ê´€ì„± ë†’ìŒ |
| **ìµœê³  ì„±ëŠ¥** | 1.2352 (Fold 4) | âœ… ëª©í‘œ ë‹¬ì„± |
| **í•™ìŠµ íš¨ìœ¨** | 65% | âœ… íš¨ìœ¨ì  |
| **ì™„ë£Œìœ¨** | 100% (5/5 Fold) | âœ… ì „ì²´ ì™„ë£Œ |

#### ì „ëµ í‰ê°€

**ì „ëµ 2: ê· í˜•ì¡íŒ ê³ ì„±ëŠ¥ (K-Fold + ì¤‘ê°„ Epoch)**
- âœ… **ëª©í‘œ ë‹¬ì„±**: ì•ˆì •ì ì´ê³  ì¼ë°˜í™”ëœ ì„±ëŠ¥ í™•ë³´
- âœ… **ì¼ê´€ì„±**: ë‚®ì€ í‘œì¤€í¸ì°¨ë¡œ ì‹ ë¢°ì„± ë†’ìŒ
- âœ… **íš¨ìœ¨ì„±**: Early Stoppingìœ¼ë¡œ í•™ìŠµ ì‹œê°„ ìµœì í™”
- âœ… **ì¬í˜„ì„±**: K-Foldë¡œ ëª¨ë¸ ì„±ëŠ¥ ê²€ì¦ ê°€ëŠ¥

### 6.2 ê¶Œì¥ì‚¬í•­

#### ë‹¨ê¸° ê°œì„ ì•ˆ

1. **Epoch ìˆ˜ ì¡°ì •**
   ```python
   # í˜„ì¬ ì„¤ì •
   epochs = 15

   # ê¶Œì¥ ì„¤ì •
   epochs = 12  # í‰ê·  ìˆ˜ë ´ epoch (9.8)ì„ ê³ ë ¤í•˜ì—¬ ì¡°ì •
   early_stopping_patience = 3  # ìœ ì§€
   ```

2. **Learning Rate ìŠ¤ì¼€ì¤„ë§ ê°œì„ **
   ```python
   # ì¶”ê°€ ê¶Œì¥ ì„¤ì •
   lr_scheduler_type = "cosine"  # í˜„ì¬: linear
   num_cycles = 0.5  # Cosine Annealing
   ```

3. **ë°ì´í„° ì¦ê°• ë¹„ìœ¨ ì‹¤í—˜**
   ```python
   # í˜„ì¬ ì„¤ì •
   augmentation_ratio = 0.5

   # ì‹¤í—˜ ê¶Œì¥
   augmentation_ratio = [0.3, 0.4, 0.5, 0.6]  # ë¹„êµ ì‹¤í—˜
   ```

#### ì¥ê¸° ê°œì„ ì•ˆ

1. **ì•™ìƒë¸” ì „ëµ ìˆ˜ë¦½**
   - 5ê°œ Fold ëª¨ë¸ì„ í™œìš©í•œ ì•™ìƒë¸”
   - ê°€ì¤‘ í‰ê·  ë˜ëŠ” Voting ë°©ì‹ ì„ íƒ
   - Fold 4 ê°€ì¤‘ì¹˜ ì¦ê°€ ê³ ë ¤ (ìµœê³  ì„±ëŠ¥)

2. **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”**
   - Optunaë¥¼ í™œìš©í•œ ìë™ íŠœë‹
   - Learning Rate, Batch Size, Gradient Accumulation ìµœì í™”
   - Beam Search íŒŒë¼ë¯¸í„° ì¡°ì •

3. **ëª¨ë¸ í¬ê¸° í™•ì¥**
   - KoBART-Large ëª¨ë¸ ì‹¤í—˜
   - ë” í° ë°°ì¹˜ í¬ê¸°ë¡œ ì¬í•™ìŠµ
   - ì¶”ê°€ ì¦ê°• ê¸°ë²• ì ìš©

### 6.3 ë‹¤ìŒ ì‹¤í—˜ ì œì•ˆ

#### ì˜µì…˜ 1: ì•™ìƒë¸” í‰ê°€
```bash
# 5ê°œ Fold ëª¨ë¸ ì•™ìƒë¸” ì¶”ë¡ 
python scripts/inference.py \
  --mode ensemble \
  --model_paths \
    experiments/20251014/20251014_090813_kobart_balanced/fold_1/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_2/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_3/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_4/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_5/default/final_model \
  --ensemble_strategy weighted \
  --weights 0.19 0.18 0.20 0.23 0.20  # Fold 4 ê°€ì¤‘ì¹˜ ì¦ê°€
```

#### ì˜µì…˜ 2: ìµœê³  ì„±ëŠ¥ Foldë§Œ ì‚¬ìš©
```bash
# Fold 4 ë‹¨ì¼ ëª¨ë¸ ì¶”ë¡  (ìµœê³  ì„±ëŠ¥)
python scripts/inference.py \
  --mode single \
  --model_path experiments/20251014/20251014_090813_kobart_balanced/fold_4/default/final_model \
  --test_data data/test.csv
```

#### ì˜µì…˜ 3: ì „ëµ 3 ì‹¤í—˜ (ê³µê²©ì  ìµœì í™”)
```bash
# ë” ë§ì€ Epochë¡œ ìµœê³  ì„±ëŠ¥ ì¶”êµ¬
python scripts/train.py \
  --mode single \
  --models kobart \
  --epochs 30 \
  --early_stopping_patience 5 \
  # ... (ë‚˜ë¨¸ì§€ íŒŒë¼ë¯¸í„° ë™ì¼)
```

---

## 7. ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´

### 7.1 ì¶”ë¡  ì‹¤í–‰ í•„ìš” âš ï¸

**í˜„ì¬ ìƒíƒœ**: âœ… í•™ìŠµ ì™„ë£Œ / âš ï¸ ì¶”ë¡  ë¯¸ì‹¤í–‰

ë³¸ ì‹¤í—˜ì€ **í•™ìŠµë§Œ ì™„ë£Œëœ ìƒíƒœ**ì…ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡ì„ ìƒì„±í•˜ë ¤ë©´ **ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³„ë„ë¡œ ì‹¤í–‰**í•´ì•¼ í•©ë‹ˆë‹¤.

### 7.2 ì¶”ë¡  ëª…ë ¹ì–´

#### ë°©ë²• 1: ì•™ìƒë¸” ì¶”ë¡  (ê¶Œì¥) ğŸŒŸ

5ê°œ Fold ëª¨ë¸ì„ ëª¨ë‘ ì‚¬ìš©í•˜ì—¬ ì•™ìƒë¸” ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.

```bash
python scripts/inference.py \
  --mode ensemble \
  --model_paths \
    experiments/20251014/20251014_090813_kobart_balanced/fold_1/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_2/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_3/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_4/default/final_model \
    experiments/20251014/20251014_090813_kobart_balanced/fold_5/default/final_model \
  --test_data data/test.csv \
  --output_path experiments/20251014/20251014_090813_kobart_balanced/predictions_ensemble.csv \
  --ensemble_strategy weighted \
  --weights 0.19 0.18 0.20 0.23 0.20 \
  --use_solar_api \
  --use_pretrained_correction \
  --correction_models gogamza/kobart-base-v2 digit82/kobart-summarization \
  --correction_strategy quality_based \
  --correction_threshold 0.3
```

**ì¥ì **:
- 5ê°œ ëª¨ë¸ì˜ ì˜ˆì¸¡ì„ ê²°í•©í•˜ì—¬ ì•ˆì •ì„± í–¥ìƒ
- Fold 4 (ìµœê³  ì„±ëŠ¥) ê°€ì¤‘ì¹˜ë¥¼ ë†’ì—¬ ì„±ëŠ¥ ê·¹ëŒ€í™”
- ì¼ë°˜í™” ì„±ëŠ¥ ìµœìƒ

#### ë°©ë²• 2: ìµœê³  ì„±ëŠ¥ Fold ë‹¨ì¼ ì¶”ë¡ 

Fold 4 ëª¨ë¸ë§Œ ì‚¬ìš©í•˜ì—¬ ë¹ ë¥¸ ì¶”ë¡ ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

```bash
python scripts/inference.py \
  --mode single \
  --model_path experiments/20251014/20251014_090813_kobart_balanced/fold_4/default/final_model \
  --test_data data/test.csv \
  --output_path experiments/20251014/20251014_090813_kobart_balanced/predictions_fold4.csv \
  --use_solar_api \
  --use_pretrained_correction \
  --correction_models gogamza/kobart-base-v2 digit82/kobart-summarization \
  --correction_strategy quality_based \
  --correction_threshold 0.3
```

**ì¥ì **:
- ê°€ì¥ ë¹ ë¥¸ ì¶”ë¡  ì†ë„
- ìµœê³  ì„±ëŠ¥ ëª¨ë¸ (ROUGE-Sum: 1.2352) ì‚¬ìš©
- ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì 

#### ë°©ë²• 3: Foldë³„ ê°œë³„ ì¶”ë¡ 

ê° Foldë³„ë¡œ ë…ë¦½ì ì¸ ì˜ˆì¸¡ì„ ìƒì„±í•©ë‹ˆë‹¤.

```bash
# Fold 1
python scripts/inference.py \
  --mode single \
  --model_path experiments/20251014/20251014_090813_kobart_balanced/fold_1/default/final_model \
  --test_data data/test.csv \
  --output_path experiments/20251014/20251014_090813_kobart_balanced/predictions_fold1.csv

# Fold 2
python scripts/inference.py \
  --mode single \
  --model_path experiments/20251014/20251014_090813_kobart_balanced/fold_2/default/final_model \
  --test_data data/test.csv \
  --output_path experiments/20251014/20251014_090813_kobart_balanced/predictions_fold2.csv

# ... (Fold 3, 4, 5 ë™ì¼í•˜ê²Œ ì‹¤í–‰)
```

**ì¥ì **:
- ê° Foldì˜ ì˜ˆì¸¡ì„ ê°œë³„ì ìœ¼ë¡œ ë¶„ì„ ê°€ëŠ¥
- ì»¤ìŠ¤í…€ ì•™ìƒë¸” ì „ëµ êµ¬í˜„ ê°€ëŠ¥

### 7.3 ì¶”ë¡  í›„ í™•ì¸ì‚¬í•­

ì¶”ë¡  ì™„ë£Œ í›„ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

1. **ì¶œë ¥ íŒŒì¼ ìƒì„± í™•ì¸**
   ```bash
   ls -lh experiments/20251014/20251014_090813_kobart_balanced/predictions_*.csv
   ```

2. **ì˜ˆì¸¡ ê²°ê³¼ ìƒ˜í”Œ í™•ì¸**
   ```bash
   head -n 5 experiments/20251014/20251014_090813_kobart_balanced/predictions_ensemble.csv
   ```

3. **ì œì¶œ íŒŒì¼ í˜•ì‹ ê²€ì¦**
   - IDì™€ summary ì»¬ëŸ¼ ì¡´ì¬ í™•ì¸
   - ê²°ì¸¡ì¹˜ ì—†ìŒ í™•ì¸
   - ì¸ì½”ë”© UTF-8 í™•ì¸

### 7.4 ì œì¶œ íŒŒì¼ ì¤€ë¹„

ì¶”ë¡ ì´ ì™„ë£Œë˜ë©´ ì œì¶œ íŒŒì¼ì„ ì¤€ë¹„í•©ë‹ˆë‹¤:

```bash
# ì œì¶œ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p submissions/20251014_kobart_balanced

# ì œì¶œ íŒŒì¼ ë³µì‚¬
cp experiments/20251014/20251014_090813_kobart_balanced/predictions_ensemble.csv \
   submissions/20251014_kobart_balanced/submission.csv

# íŒŒì¼ ì •ë³´ í™•ì¸
wc -l submissions/20251014_kobart_balanced/submission.csv
head submissions/20251014_kobart_balanced/submission.csv
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ì‹¤í—˜ ê´€ë ¨ ë¬¸ì„œ
- [ì „ëµ 2 ë¬¸ì„œ](../../docs/ëª¨ë“ˆí™”/04_02_*.md): ë³¸ ì‹¤í—˜ì˜ ê¸°ë°˜ ì „ëµ
- [ëª¨ë¸ ì„¤ì •](../../configs/models/kobart.yaml): KoBART ëª¨ë¸ ì„¤ì •
- [í•™ìŠµ íŒŒë¼ë¯¸í„°](../../configs/training/balanced.yaml): í•™ìŠµ í•˜ì´í¼íŒŒë¼ë¯¸í„°

### ì‹¤í—˜ íŒŒì¼ ìœ„ì¹˜
- **í•™ìŠµ ë¡œê·¸**: `experiments/20251014/20251014_090813_kobart_balanced/train.log`
- **Fold ëª¨ë¸ë“¤**: `experiments/20251014/20251014_090813_kobart_balanced/fold_*/default/final_model/`
- **ì²´í¬í¬ì¸íŠ¸ë“¤**: `experiments/20251014/20251014_090813_kobart_balanced/fold_*/default/checkpoint-*/`

### ì¬í˜„ ë°©ë²•
```bash
# ë™ì¼í•œ ì‹¤í—˜ ì¬í˜„
python scripts/train.py \
  --mode kfold \
  --models kobart \
  --epochs 15 \
  --batch_size 16 \
  --gradient_accumulation_steps 10 \
  --learning_rate 5e-5 \
  --warmup_ratio 0.1 \
  --weight_decay 0.01 \
  --max_grad_norm 1.0 \
  --label_smoothing 0.1 \
  --use_augmentation \
  --augmentation_ratio 0.5 \
  --augmentation_methods back_translation paraphrase \
  --k_folds 5 \
  --fold_seed 42 \
  --max_new_tokens 100 \
  --min_new_tokens 30 \
  --num_beams 5 \
  --repetition_penalty 1.5 \
  --length_penalty 1.0 \
  --no_repeat_ngram_size 3 \
  --use_solar_api \
  --use_pretrained_correction \
  --correction_models gogamza/kobart-base-v2 digit82/kobart-summarization \
  --correction_strategy quality_based \
  --correction_threshold 0.3 \
  --experiment_name kobart_balanced \
  --seed 42
```

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2025-10-14
**ì‘ì„±ì**: Claude Code
**ë²„ì „**: 1.0

